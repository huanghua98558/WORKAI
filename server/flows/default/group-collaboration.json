{
  "id": "flow_group_collaboration",
  "name": "群组协作流程",
  "description": "多机器人协同工作，支持群组消息分发和任务分配",
  "version": "1.0.0",
  "triggerType": "webhook",
  "triggerConfig": {
    "webhookUrl": "/api/worktool/callback",
    "eventType": "group_message"
  },
  "nodes": [
    {
      "id": "node_01",
      "type": "message_receive",
      "position": { "x": 100, "y": 100 },
      "data": {
        "name": "消息接收",
        "description": "接收群组消息",
        "config": {
          "saveToInfoCenter": true,
          "senderIdentification": true
        }
      }
    },
    {
      "id": "node_02",
      "type": "decision",
      "position": { "x": 250, "y": 100 },
      "data": {
        "name": "群组识别",
        "description": "识别消息所属群组",
        "config": {
          "conditions": [
            {
              "expression": "context.groupType === 'vip'",
              "label": "VIP群",
              "targetNodeId": "node_03"
            },
            {
              "expression": "context.groupType === 'support'",
              "label": "技术支持群",
              "targetNodeId": "node_04"
            },
            {
              "expression": "context.groupType === 'sales'",
              "label": "销售群",
              "targetNodeId": "node_05"
            }
          ]
        }
      }
    },
    {
      "id": "node_03",
      "type": "robot_dispatch",
      "position": { "x": 400, "y": 250 },
      "data": {
        "name": "机器人A",
        "description": "VIP专属机器人",
        "config": {
          "robotId": "robot_vip_001",
          "priority": "high"
        }
      }
    },
    {
      "id": "node_04",
      "type": "robot_dispatch",
      "position": { "x": 400, "y": 100 },
      "data": {
        "name": "机器人B",
        "description": "技术支持机器人",
        "config": {
          "robotId": "robot_support_001",
          "priority": "medium"
        }
      }
    },
    {
      "id": "node_05",
      "type": "robot_dispatch",
      "position": { "x": 400, "y": -50 },
      "data": {
        "name": "机器人C",
        "description": "销售机器人",
        "config": {
          "robotId": "robot_sales_001",
          "priority": "low"
        }
      }
    },
    {
      "id": "node_06",
      "type": "intent",
      "position": { "x": 550, "y": 250 },
      "data": {
        "name": "意图识别",
        "description": "识别用户意图",
        "config": {
          "modelId": "doubao-pro-4k",
          "supportedIntents": ["咨询", "投诉", "售后", "互动", "购买"]
        }
      }
    },
    {
      "id": "node_07",
      "type": "ai_reply",
      "position": { "x": 700, "y": 250 },
      "data": {
        "name": "AI回复",
        "description": "VIP专属回复",
        "config": {
          "modelId": "doubao-pro-4k",
          "useTemplate": true,
          "templateId": "template_vip",
          "temperature": 0.8
        }
      }
    },
    {
      "id": "node_08",
      "type": "ai_reply",
      "position": { "x": 700, "y": 100 },
      "data": {
        "name": "AI回复",
        "description": "技术支持回复",
        "config": {
          "modelId": "doubao-pro-4k",
          "useTemplate": true,
          "templateId": "template_support",
          "temperature": 0.6
        }
      }
    },
    {
      "id": "node_09",
      "type": "staff_intervention",
      "position": { "x": 700, "y": -50 },
      "data": {
        "name": "转人工",
        "description": "销售转人工",
        "config": {
          "autoAssign": true,
          "assignTo": "sales_team"
        }
      }
    },
    {
      "id": "node_10",
      "type": "message_sync",
      "position": { "x": 850, "y": 175 },
      "data": {
        "name": "消息汇总",
        "description": "汇总所有机器人回复",
        "config": {
          "syncChannels": ["all"],
          "deduplicate": true
        }
      }
    },
    {
      "id": "node_11",
      "type": "data_transform",
      "position": { "x": 1000, "y": 175 },
      "data": {
        "name": "去重处理",
        "description": "去重和格式化",
        "config": {
          "transformRules": [
            {
              "rule": "remove_duplicates",
              "field": "content"
            },
            {
              "rule": "format_timestamp",
              "format": "YYYY-MM-DD HH:mm:ss"
            }
          ]
        }
      }
    },
    {
      "id": "node_12",
      "type": "send_command",
      "position": { "x": 1150, "y": 175 },
      "data": {
        "name": "消息发送",
        "description": "发送最终回复",
        "config": {
          "saveToInfoCenter": true,
          "broadcast": true
        }
      }
    },
    {
      "id": "node_13",
      "type": "end",
      "position": { "x": 1300, "y": 175 },
      "data": {
        "name": "结束",
        "description": "流程结束"
      }
    }
  ],
  "edges": [
    { "id": "edge_01", "source": "node_01", "target": "node_02" },
    { "id": "edge_02", "source": "node_02", "target": "node_03", "label": "VIP群" },
    { "id": "edge_03", "source": "node_02", "target": "node_04", "label": "技术支持群" },
    { "id": "edge_04", "source": "node_02", "target": "node_05", "label": "销售群" },
    { "id": "edge_05", "source": "node_03", "target": "node_06" },
    { "id": "edge_06", "source": "node_04", "target": "node_08" },
    { "id": "edge_07", "source": "node_05", "target": "node_09" },
    { "id": "edge_08", "source": "node_06", "target": "node_07" },
    { "id": "edge_09", "source": "node_07", "target": "node_10" },
    { "id": "edge_10", "source": "node_08", "target": "node_10" },
    { "id": "edge_11", "source": "node_09", "target": "node_10" },
    { "id": "edge_12", "source": "node_10", "target": "node_11" },
    { "id": "edge_13", "source": "node_11", "target": "node_12" },
    { "id": "edge_14", "source": "node_12", "target": "node_13" }
  ]
}
