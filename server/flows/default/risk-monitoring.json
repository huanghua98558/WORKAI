{
  "id": "flow_risk_monitoring",
  "name": "风险监控流程",
  "description": "实时监控群内消息，检测风险内容并触发告警",
  "version": "1.0.0",
  "triggerType": "scheduled",
  "triggerConfig": {
    "cronExpression": "*/5 * * * *",
    "description": "每5分钟执行一次"
  },
  "nodes": [
    {
      "id": "node_01",
      "type": "start",
      "position": { "x": 100, "y": 100 },
      "data": {
        "name": "开始",
        "description": "流程开始",
        "config": {
          "initialVariables": {
            "startTime": "{{now}}",
            "monitorType": "group"
          }
        }
      }
    },
    {
      "id": "node_02",
      "type": "monitor",
      "position": { "x": 250, "y": 100 },
      "data": {
        "name": "监控节点",
        "description": "实时监听群内消息",
        "config": {
          "monitorType": "group",
          "timeRange": "5m",
          "keywords": ["投诉", "骗子", "差评", "退款", "欺诈"],
          "excludeKeywords": ["好的", "谢谢", "满意"]
        }
      }
    },
    {
      "id": "node_03",
      "type": "risk_detect",
      "position": { "x": 400, "y": 100 },
      "data": {
        "name": "风险检测",
        "description": "检测消息风险",
        "config": {
          "riskRules": [
            {
              "ruleName": "敏感词检测",
              "conditions": {
                "hasSensitiveKeywords": true
              },
              "riskLevel": 2
            },
            {
              "ruleName": "高频投诉",
              "conditions": {
                "complaintCount": 3
              },
              "riskLevel": 3
            },
            {
              "ruleName": "异常行为",
              "conditions": {
                "messageFrequency": "> 10/min"
              },
              "riskLevel": 4
            }
          ]
        }
      }
    },
    {
      "id": "node_04",
      "type": "decision",
      "position": { "x": 550, "y": 100 },
      "data": {
        "name": "风险等级判断",
        "description": "根据风险等级决定处理方式",
        "config": {
          "conditions": [
            {
              "expression": "context.riskLevel >= 4",
              "label": "高风险",
              "targetNodeId": "node_05"
            },
            {
              "expression": "context.riskLevel === 3",
              "label": "中风险",
              "targetNodeId": "node_07"
            },
            {
              "expression": "context.riskLevel <= 2",
              "label": "低风险",
              "targetNodeId": "node_09"
            }
          ]
        }
      }
    },
    {
      "id": "node_05",
      "type": "alert_save",
      "position": { "x": 700, "y": 250 },
      "data": {
        "name": "告警入库",
        "description": "保存高风险告警",
        "config": {
          "alertLevel": "critical",
          "alertType": "risk",
          "message": "检测到高风险内容"
        }
      }
    },
    {
      "id": "node_06",
      "type": "alert_notify",
      "position": { "x": 850, "y": 250 },
      "data": {
        "name": "发送通知",
        "description": "通知管理层",
        "config": {
          "channels": ["email", "sms", "phone"],
          "recipients": ["admin", "manager"],
          "priority": "urgent"
        }
      }
    },
    {
      "id": "node_07",
      "type": "log_save",
      "position": { "x": 700, "y": 100 },
      "data": {
        "name": "记录日志",
        "description": "记录中风险日志",
        "config": {
          "logLevel": "warn",
          "message": "检测到中风险内容"
        }
      }
    },
    {
      "id": "node_08",
      "type": "alert_escalate",
      "position": { "x": 850, "y": 100 },
      "data": {
        "name": "升级判断",
        "description": "判断是否需要升级",
        "config": {
          "escalationRules": [
            {
              "condition": "context.repeatCount >= 3",
              "escalateTo": "high"
            }
          ]
        }
      }
    },
    {
      "id": "node_09",
      "type": "log_save",
      "position": { "x": 700, "y": -50 },
      "data": {
        "name": "正常处理",
        "description": "记录低风险日志",
        "config": {
          "logLevel": "info",
          "message": "检测到低风险内容"
        }
      }
    },
    {
      "id": "node_10",
      "type": "end",
      "position": { "x": 1000, "y": 100 },
      "data": {
        "name": "结束",
        "description": "流程结束"
      }
    }
  ],
  "edges": [
    { "id": "edge_01", "source": "node_01", "target": "node_02" },
    { "id": "edge_02", "source": "node_02", "target": "node_03" },
    { "id": "edge_03", "source": "node_03", "target": "node_04" },
    { "id": "edge_04", "source": "node_04", "target": "node_05", "label": "高风险" },
    { "id": "edge_05", "source": "node_04", "target": "node_07", "label": "中风险" },
    { "id": "edge_06", "source": "node_04", "target": "node_09", "label": "低风险" },
    { "id": "edge_07", "source": "node_05", "target": "node_06" },
    { "id": "edge_08", "source": "node_06", "target": "node_10" },
    { "id": "edge_09", "source": "node_07", "target": "node_08" },
    { "id": "edge_10", "source": "node_08", "target": "node_10" },
    { "id": "edge_11", "source": "node_09", "target": "node_10" }
  ]
}
