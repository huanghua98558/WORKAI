# æµç¨‹å¼•æ“èŠ‚ç‚¹é…ç½®è¯¦ç»†è®¾è®¡ v3.0ï¼ˆåŸºäºå†…éƒ¨æ–‡æ¡£ï¼‰

## ğŸ“‹ è®¾è®¡ç›®æ ‡

- **èŠ‚ç‚¹æ•°é‡**: 10ä¸ªï¼ˆç²¾ç®€ä½†å®Œæ•´ï¼‰
- **åŠ¨ä½œæ€»æ•°**: 71ä¸ªï¼ˆè¦†ç›–æ‰€æœ‰ç³»ç»Ÿè”åŠ¨ï¼‰
- **è¦†ç›–ç³»ç»Ÿ**: æ¶ˆæ¯ä¸­å¿ƒã€AIæ¨¡å—ã€æœºå™¨äººç®¡ç†ã€å‘Šè­¦ç³»ç»Ÿã€é£é™©ç®¡ç†ã€ç›‘æ§ç³»ç»Ÿã€ååŒç³»ç»Ÿã€æµç¨‹æ§åˆ¶
- **è®¾è®¡åŸåˆ™**: æ¯ä¸ªèŠ‚ç‚¹æ”¯æŒå¤šä¸ªä»»åŠ¡/æ“ä½œï¼Œé¿å…åŠŸèƒ½é‡å 
- **é…ç½®è¦æ±‚**: è€ƒè™‘ä¼ä¸šå¾®ä¿¡APIè°ƒç”¨ç»†èŠ‚ï¼ˆ@äººã€é‡è¯•ã€è´Ÿè½½å‡è¡¡ï¼‰

---

## ğŸ—ï¸ èŠ‚ç‚¹ä½“ç³»æ¶æ„

### èŠ‚ç‚¹åˆ†ç±»ä¸å…³ç³»

```
æµç¨‹å¼•æ“ (10ä¸ªèŠ‚ç‚¹)
â”‚
â”œâ”€â”€ å…¥å£èŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ MESSAGE_ENTRY (æ¶ˆæ¯å…¥å£)
â”‚
â”œâ”€â”€ AIåˆ†æèŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ SMART_ANALYZE (æ™ºèƒ½åˆ†æ)
â”‚
â”œâ”€â”€ å†³ç­–èŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ FLOW_DECISION (æµç¨‹å†³ç­–)
â”‚
â”œâ”€â”€ ä¸šåŠ¡å¤„ç†èŠ‚ç‚¹ (3ä¸ª)
â”‚   â”œâ”€â”€ AI_AGENT (AIä»£ç†)
â”‚   â”œâ”€â”€ RISK_HANDLER (é£é™©å¤„ç†)
â”‚   â””â”€â”€ STAFF_COOPERATE (å·¥ä½œäººå‘˜ååŒ)
â”‚
â”œâ”€â”€ æ¶ˆæ¯æ“ä½œèŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ MESSAGE_EXIT (æ¶ˆæ¯å‡ºå£)
â”‚
â”œâ”€â”€ ç›‘æ§æ£€æµ‹èŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ SMART_MONITOR (æ™ºèƒ½ç›‘æ§)
â”‚
â”œâ”€â”€ å‘Šè­¦å‡çº§èŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ ALERT_ESCALATION (å‘Šè­¦å‡çº§)
â”‚
â”œâ”€â”€ äººå·¥æ¥ç®¡èŠ‚ç‚¹ (1ä¸ª)
â”‚   â””â”€â”€ HUMAN_HANDOVER (äººå·¥æ¥ç®¡)
â”‚
â””â”€â”€ ç»“æŸèŠ‚ç‚¹ (1ä¸ª)
    â””â”€â”€ FLOW_END (æµç¨‹ç»“æŸ)
```

---

## ğŸ“ èŠ‚ç‚¹1: MESSAGE_ENTRYï¼ˆæ¶ˆæ¯å…¥å£ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ“¥
- **é¢œè‰²**: #10b981ï¼ˆç»¿è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
æ¥æ”¶WorkToolæ¶ˆæ¯ï¼Œæ‰§è¡Œæ¶ˆæ¯æ¥æ”¶ã€ä¿å­˜ã€è§£æã€ä¼šè¯åˆ›å»ºã€ä¸Šä¸‹æ–‡åŠ è½½ç­‰åˆå§‹åŒ–æ“ä½œã€‚è¿™æ˜¯æµç¨‹çš„èµ·ç‚¹ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… æ¶ˆæ¯ä¸­å¿ƒï¼ˆæ¶ˆæ¯æ¥æ”¶ã€ä¼šè¯ç®¡ç†ï¼‰
- âœ… æœºå™¨äººç®¡ç†ï¼ˆæœºå™¨äººçŠ¶æ€æ£€æŸ¥ï¼‰
- âœ… ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆå†å²æ¶ˆæ¯åŠ è½½ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ6ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: æ¶ˆæ¯æ¥æ”¶
```javascript
{
  actionId: "message_receive",
  actionName: "æ¶ˆæ¯æ¥æ”¶",
  enabled: true,
  config: {
    // æ¥æ”¶é…ç½®
    validateMessage: true,           // æ˜¯å¦éªŒè¯æ¶ˆæ¯æ ¼å¼
    skipEmptyMessages: true,         // æ˜¯å¦è·³è¿‡ç©ºæ¶ˆæ¯
    skipSelfMessages: true,          // æ˜¯å¦è·³è¿‡æœºå™¨äººè‡ªå·±çš„æ¶ˆæ¯
    acceptTypes: ["text", "image", "file", "audio", "video"], // æ¥å—çš„æ¶ˆæ¯ç±»å‹
    maxMessageLength: 10000,         // æœ€å¤§æ¶ˆæ¯é•¿åº¦é™åˆ¶
    // APIåœ°å€
    webhookUrl: "POST /api/worktool/callback/message",
    // å“åº”
    immediateResponse: true          // æ˜¯å¦ç«‹å³è¿”å›200
  }
}
```

#### åŠ¨ä½œ2: æ¶ˆæ¯ä¿å­˜
```javascript
{
  actionId: "message_save",
  actionName: "æ¶ˆæ¯ä¿å­˜",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    saveToContext: true,             // æ˜¯å¦ä¿å­˜åˆ°æµç¨‹ä¸Šä¸‹æ–‡
    tableName: "messages",           // ç›®æ ‡è¡¨
    // å­—æ®µæ˜ å°„
    fieldMapping: {
      messageId: "messageId",        // æ¶ˆæ¯ID
      sessionId: "sessionId",        // ä¼šè¯ID
      robotId: "robotId",            // æœºå™¨äººID
      robotType: "robotType",        // æœºå™¨äººç±»å‹ï¼ˆofficial/customï¼‰
      senderId: "senderId",          // å‘é€è€…ID
      senderName: "senderName",      // å‘é€è€…åç§°
      senderType: "senderType",      // å‘é€è€…ç±»å‹ï¼ˆuser/systemï¼‰
      groupName: "groupName",        // ç¾¤ç»„åç§°
      groupChatId: "groupChatId",    // ç¾¤ç»„ID
      roomType: "roomType",          // æˆ¿é—´ç±»å‹ï¼ˆgroup/privateï¼‰
      messageType: "messageType",    // æ¶ˆæ¯ç±»å‹
      content: "content",            // æ¶ˆæ¯å†…å®¹
      atMe: "atMe",                  // æ˜¯å¦@æˆ‘
      atList: "atList",              // @äººåˆ—è¡¨
      timestamp: "timestamp",        // æ—¶é—´æˆ³
      metadata: "metadata"           // å…ƒæ•°æ®ï¼ˆJSONï¼‰
    },
    // å»é‡é…ç½®
    enableDeduplication: true,       // æ˜¯å¦å¯ç”¨å»é‡
    dedupWindow: 5000                // å»é‡æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰
  }
}
```

#### åŠ¨ä½œ3: æ¶ˆæ¯è§£æ
```javascript
{
  actionId: "message_parse",
  actionName: "æ¶ˆæ¯è§£æ",
  enabled: true,
  config: {
    // æå–å­—æ®µ
    extractFields: [
      "messageId",
      "sessionId",
      "robotId",
      "robotType",
      "senderId",
      "senderName",
      "groupName",
      "groupChatId",
      "roomType",
      "messageType",
      "content",
      "atMe",
      "atList"
    ],
    // @äººè§£æ
    parseAtList: true,               // æ˜¯å¦è§£æ@äººåˆ—è¡¨
    atListFormat: "array",           // @äººåˆ—è¡¨æ ¼å¼ï¼ˆarray/stringï¼‰
    // ä¼ä¸šå¾®ä¿¡æœºå™¨äººç‰¹å®š
    parseWebhookData: true,          // æ˜¯å¦è§£æä¼ä¸šå¾®ä¿¡Webhookæ•°æ®
    webhookFieldMapping: {
      robotType: "official",         // ä¼ä¸šå¾®ä¿¡æœºå™¨äººç±»å‹
      webhookKey: "webhook_key"      // Webhook key
    },
    // è‡ªå®šä¹‰æœºå™¨äººç‰¹å®š
    parseCustomRobotData: true,      // æ˜¯å¦è§£æè‡ªå®šä¹‰æœºå™¨äººæ•°æ®
    customFieldMapping: {
      robotType: "custom",           // è‡ªå®šä¹‰æœºå™¨äººç±»å‹
      robotSecret: "robot_secret"    // æœºå™¨äººå¯†é’¥
    }
  }
}
```

#### åŠ¨ä½œ4: ä¼šè¯åˆ›å»º
```javascript
{
  actionId: "session_create",
  actionName: "ä¼šè¯åˆ›å»º",
  enabled: true,
  config: {
    // ä¼šè¯è¯†åˆ«
    sessionIdSource: "generate",     // ä¼šè¯IDæ¥æºï¼ˆgenerate/existing/robotï¼‰
    sessionKeyFields: ["senderId", "robotId", "roomType"], // ä¼šè¯æ ‡è¯†å­—æ®µ
    // ä¼šè¯åˆ›å»º
    createNewSession: true,          // æ˜¯å¦åˆ›å»ºæ–°ä¼šè¯
    updateExistingSession: true,     // æ˜¯å¦æ›´æ–°ç°æœ‰ä¼šè¯
    tableName: "sessions",           // ç›®æ ‡è¡¨
    // ä¼šè¯å­—æ®µ
    sessionFields: {
      sessionId: "sessionId",
      robotId: "robotId",
      userId: "senderId",
      userName: "senderName",
      groupName: "groupName",
      groupChatId: "groupChatId",
      roomType: "roomType",
      status: "active",
      messageCount: 0,
      lastMessageTime: "timestamp",
      metadata: "metadata"
    },
    // ä¼šè¯ç»Ÿè®¡
    incrementMessageCount: true,     // æ˜¯å¦é€’å¢æ¶ˆæ¯è®¡æ•°
    updateLastMessageTime: true      // æ˜¯å¦æ›´æ–°æœ€åæ¶ˆæ¯æ—¶é—´
  }
}
```

#### åŠ¨ä½œ5: ä¸Šä¸‹æ–‡åŠ è½½
```javascript
{
  actionId: "context_load",
  actionName: "ä¸Šä¸‹æ–‡åŠ è½½",
  enabled: true,
  config: {
    // ä¸Šä¸‹æ–‡æ¨¡å¼
    contextMode: "sliding_window",  // ä¸Šä¸‹æ–‡æ¨¡å¼ï¼ˆfull_history/sliding_window/summaryï¼‰
    windowSize: 10,                 // ä¸Šä¸‹æ–‡çª—å£å¤§å°ï¼ˆè½®æ•°ï¼‰
    maxTokens: 4000,                // æœ€å¤§Tokenæ•°
    // åŠ è½½å†å²
    loadHistoryMessages: true,      // æ˜¯å¦åŠ è½½å†å²æ¶ˆæ¯
    historyFields: [
      "messageId",
      "senderId",
      "senderName",
      "messageType",
      "content",
      "timestamp"
    ],
    // æ’åºé…ç½®
    sortOrder: "asc",               // æ’åºæ–¹å‘ï¼ˆasc/descï¼‰
    sortBy: "timestamp",            // æ’åºå­—æ®µ
    // ä¸Šä¸‹æ–‡è¾“å‡º
    saveToContext: true,            // æ˜¯å¦ä¿å­˜åˆ°æµç¨‹ä¸Šä¸‹æ–‡
    contextKey: "conversationContext" // ä¸Šä¸‹æ–‡å˜é‡å
  }
}
```

#### åŠ¨ä½œ6: è¾“å‡ºæµç¨‹å˜é‡
```javascript
{
  actionId: "output_variables",
  actionName: "è¾“å‡ºæµç¨‹å˜é‡",
  enabled: true,
  config: {
    // è¾“å‡ºå˜é‡
    outputVariables: {
      messageId: "message.messageId",
      sessionId: "message.sessionId",
      robotId: "message.robotId",
      robotType: "message.robotType",
      senderId: "message.senderId",
      senderName: "message.senderName",
      senderType: "message.senderType",
      groupName: "message.groupName",
      groupChatId: "message.groupChatId",
      roomType: "message.roomType",
      messageType: "message.messageType",
      content: "message.content",
      atMe: "message.atMe",
      atList: "message.atList",
      timestamp: "message.timestamp",
      conversationContext: "context.conversationContext"
    }
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  message: {
    messageId: "msg_123456",
    sessionId: "sess_789012",
    robotId: "robot_001",
    robotType: "official",  // official/custom
    senderId: "user_001",
    senderName: "å¼ ä¸‰",
    senderType: "user",
    groupName: "å®¢æˆ·ç¾¤",
    groupChatId: "group_001",
    roomType: "group",
    messageType: "text",
    content: "æˆ‘è¦é€€è´§",
    atMe: true,
    atList: ["robot_001"],
    timestamp: "2025-01-04T10:00:00Z",
    metadata: {}
  },
  session: {
    sessionId: "sess_789012",
    status: "active",
    messageCount: 1
  },
  conversationContext: [
    {
      role: "user",
      content: "æˆ‘è¦é€€è´§",
      timestamp: "2025-01-04T10:00:00Z"
    }
  ]
}
```

---

## ğŸ“ èŠ‚ç‚¹2: SMART_ANALYZEï¼ˆæ™ºèƒ½åˆ†æï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ§ 
- **é¢œè‰²**: #8b5cf6ï¼ˆç´«è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
ä½¿ç”¨AIè¿›è¡Œæ„å›¾è¯†åˆ«ã€æƒ…ç»ªåˆ†æã€ä¿¡æ¯æ£€æµ‹ã€å®ä½“è¯†åˆ«ç­‰æ™ºèƒ½åˆ†æï¼Œä¸ºåç»­å†³ç­–æä¾›ä¾æ®ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… AIæ¨¡å—ï¼ˆæ„å›¾è¯†åˆ«ã€æƒ…ç»ªåˆ†æï¼‰
- âœ… ä¿¡æ¯ä¸­å¿ƒï¼ˆä¿¡æ¯æ£€æµ‹ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ6ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: æ„å›¾è¯†åˆ«
```javascript
{
  actionId: "intent_recognition",
  actionName: "æ„å›¾è¯†åˆ«",
  enabled: true,
  config: {
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-4k-intent", // æ¨¡å‹IDï¼ˆè±†åŒ…æ„å›¾è¯†åˆ«æ¨¡å‹ï¼‰
    fallbackModelId: "doubao-pro-32k-service", // å¤‡ç”¨æ¨¡å‹
    // æ„å›¾åˆ—è¡¨
    supportedIntents: [
      {
        intentId: "service",
        intentName: "æœåŠ¡å’¨è¯¢",
        description: "ç”¨æˆ·å’¨è¯¢äº§å“æˆ–æœåŠ¡ç›¸å…³é—®é¢˜"
      },
      {
        intentId: "complaint",
        intentName: "æŠ•è¯‰",
        description: "ç”¨æˆ·å¯¹äº§å“æˆ–æœåŠ¡è¡¨ç¤ºä¸æ»¡"
      },
      {
        intentId: "after_sales",
        intentName: "å”®å",
        description: "ç”¨æˆ·ç”³è¯·é€€æ¢è´§ã€ç»´ä¿®ç­‰å”®åé—®é¢˜"
      },
      {
        intentId: "conversion",
        intentName: "è½¬åŒ–",
        description: "ç”¨æˆ·æœ‰è´­ä¹°æ„å‘"
      },
      {
        intentId: "risk",
        intentName: "é£é™©",
        description: "ç”¨æˆ·å‘é€æ•æ„Ÿæˆ–æ”»å‡»æ€§å†…å®¹"
      },
      {
        intentId: "spam",
        intentName: "åƒåœ¾ä¿¡æ¯",
        description: "ç”¨æˆ·å‘é€å¹¿å‘Šã€éªšæ‰°ç­‰ä¿¡æ¯"
      },
      {
        intentId: "chat",
        intentName: "é—²èŠ",
        description: "ç”¨æˆ·è¿›è¡Œæ—¥å¸¸é—²èŠ"
      }
    ],
    // é˜ˆå€¼é…ç½®
    confidenceThreshold: 0.7,       // ç½®ä¿¡åº¦é˜ˆå€¼
    fallbackIntent: "chat",          // é»˜è®¤æ„å›¾
    // ä¸Šä¸‹æ–‡
    useContext: true,                // æ˜¯å¦ä½¿ç”¨ä¸Šä¸‹æ–‡
    contextLength: 3,                // ä¸Šä¸‹æ–‡è½®æ•°
    // æç¤ºè¯
    systemPrompt: "ä½ æ˜¯ä¸€ä¸ªæ„å›¾è¯†åˆ«ä¸“å®¶ã€‚è¯·åˆ†æç”¨æˆ·çš„è¾“å…¥ï¼Œè¯†åˆ«å…¶æ„å›¾ã€‚",
    customPrompt: "",                // è‡ªå®šä¹‰æç¤ºè¯
    // è¾“å‡º
    saveToContext: true,             // æ˜¯å¦ä¿å­˜åˆ°æµç¨‹ä¸Šä¸‹æ–‡
    contextKey: "intentResult"       // ä¸Šä¸‹æ–‡å˜é‡å
  }
}
```

#### åŠ¨ä½œ2: æƒ…ç»ªåˆ†æ
```javascript
{
  actionId: "emotion_analysis",
  actionName: "æƒ…ç»ªåˆ†æ",
  enabled: true,
  config: {
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-4k-intent",
    // æƒ…ç»ªåˆ—è¡¨
    supportedEmotions: [
      {
        emotionId: "positive",
        emotionName: "æ­£é¢",
        description: "ç”¨æˆ·æƒ…ç»ªç§¯æã€æ»¡æ„"
      },
      {
        emotionId: "neutral",
        emotionName: "ä¸­æ€§",
        description: "ç”¨æˆ·æƒ…ç»ªå¹³ç¨³"
      },
      {
        emotionId: "negative",
        emotionName: "è´Ÿé¢",
        description: "ç”¨æˆ·æƒ…ç»ªæ¶ˆæã€ä¸æ»¡"
      },
      {
        emotionId: "angry",
        emotionName: "æ„¤æ€’",
        description: "ç”¨æˆ·æƒ…ç»ªæ„¤æ€’ã€æ¿€åŠ¨"
      },
      {
        emotionId: "sad",
        emotionName: "æ‚²ä¼¤",
        description: "ç”¨æˆ·æƒ…ç»ªæ‚²ä¼¤"
      },
      {
        emotionId: "anxious",
        emotionName: "ç„¦è™‘",
        description: "ç”¨æˆ·æƒ…ç»ªç„¦è™‘ã€ä¸å®‰"
      }
    ],
    // é˜ˆå€¼é…ç½®
    scoreThreshold: 0.6,             // æƒ…ç»ªå¾—åˆ†é˜ˆå€¼
    // ä¸Šä¸‹æ–‡
    useContext: true,
    // è¾“å‡º
    saveToContext: true,
    contextKey: "emotionResult"
  }
}
```

#### åŠ¨ä½œ3: æ•æ„Ÿä¿¡æ¯æ£€æµ‹
```javascript
{
  actionId: "sensitive_info_detection",
  actionName: "æ•æ„Ÿä¿¡æ¯æ£€æµ‹",
  enabled: true,
  config: {
    // æ£€æµ‹ç±»å‹
    detectionTypes: [
      "phone",       // æ‰‹æœºå·
      "email",       // é‚®ç®±
      "id_card",     // èº«ä»½è¯
      "bank_card",   // é“¶è¡Œå¡
      "address",     // åœ°å€
      "company"      // å…¬å¸åç§°
    ],
    // æ•æ„Ÿè¯æ£€æµ‹
    enableSensitiveWordDetection: true, // æ˜¯å¦å¯ç”¨æ•æ„Ÿè¯æ£€æµ‹
    sensitiveWordList: [
      "æš´åŠ›",
      "è‰²æƒ…",
      "èµŒåš",
      "è‡ªæ€",
      "ç‚¸å¼¹"
    ],
    // æ¨¡ç³ŠåŒ¹é…
    enableFuzzyMatch: true,         // æ˜¯å¦å¯ç”¨æ¨¡ç³ŠåŒ¹é…
    fuzzyMatchThreshold: 0.8,       // æ¨¡ç³ŠåŒ¹é…é˜ˆå€¼
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-4k-intent",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "sensitiveInfoResult"
  }
}
```

#### åŠ¨ä½œ4: å®ä½“è¯†åˆ«
```javascript
{
  actionId: "entity_recognition",
  actionName: "å®ä½“è¯†åˆ«",
  enabled: true,
  config: {
    // å®ä½“ç±»å‹
    entityTypes: [
      "person",      // äººå
      "company",     // å…¬å¸åç§°
      "product",     // äº§å“å
      "price",       // ä»·æ ¼
      "date",        // æ—¥æœŸ
      "time",        // æ—¶é—´
      "location",    // åœ°ç‚¹
      "phone",       // ç”µè¯
      "email"        // é‚®ç®±
    ],
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-4k-intent",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "entityResult"
  }
}
```

#### åŠ¨ä½œ5: å·¥ä½œäººå‘˜è¯†åˆ«
```javascript
{
  actionId: "staff_identification",
  actionName: "å·¥ä½œäººå‘˜è¯†åˆ«",
  enabled: true,
  config: {
    // è¯†åˆ«ç­–ç•¥ï¼ˆåŸºäºç‰¹å¾åŒ¹é…ï¼‰
    identificationStrategies: [
      "company_name",      // å…¬å¸åç§°åŒ¹é…
      "remark_name",       // å¤‡æ³¨ååŒ¹é…
      "nickname",          // æ˜µç§°åŒ¹é…
      "special_keyword"    // ç‰¹æ®Šå…³é”®è¯åŒ¹é…
    ],
    // ä¼ä¸šåç§°ç‰¹å¾
    companyFeatures: [
      "å…¬å¸",
      "æœ‰é™",
      "ç§‘æŠ€",
      "é›†å›¢"
    ],
    // å¤‡æ³¨åç‰¹å¾
    remarkFeatures: [
      "å®¢æœ",
      "æŠ€æœ¯",
      "å”®å",
      "è¿è¥",
      "ç»ç†"
    ],
    // ç‰¹æ®Šå…³é”®è¯
    specialKeywords: [
      "æˆ‘æ–¹äººå‘˜",
      "æœ¬å¸",
      "å†…éƒ¨"
    ],
    // æ•°æ®åº“æŸ¥è¯¢
    queryStaffTable: true,           // æ˜¯å¦æŸ¥è¯¢å·¥ä½œäººå‘˜è¡¨
    staffTableName: "staff",         // å·¥ä½œäººå‘˜è¡¨
    // è¾“å‡º
    saveToContext: true,
    contextKey: "staffResult"
  }
}
```

#### åŠ¨ä½œ6: ä¿¡æ¯ä¸­å¿ƒæ•´åˆ
```javascript
{
  actionId: "info_center_integration",
  actionName: "ä¿¡æ¯ä¸­å¿ƒæ•´åˆ",
  enabled: true,
  config: {
    // è°ƒç”¨ä¿¡æ¯ä¸­å¿ƒAPI
    callInfoCenterAPI: true,        // æ˜¯å¦è°ƒç”¨ä¿¡æ¯ä¸­å¿ƒAPI
    infoCenterEndpoint: "/api/info-center/analyze", // APIç«¯ç‚¹
    // æ•´åˆå­—æ®µ
    integrateFields: [
      "intent",
      "emotion",
      "entities",
      "sensitiveInfo",
      "staffIdentified"
    ],
    // ä¿å­˜åˆ†æç»“æœ
    saveToInfoCenter: true,         // æ˜¯å¦ä¿å­˜åˆ°ä¿¡æ¯ä¸­å¿ƒ
    infoCenterTable: "message_analytics", // ç›®æ ‡è¡¨
    // è¾“å‡º
    saveToContext: true,
    contextKey: "infoCenterResult"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  intentResult: {
    intent: "complaint",
    intentName: "æŠ•è¯‰",
    confidence: 0.95,
    needReply: true,
    needHuman: true
  },
  emotionResult: {
    emotion: "angry",
    emotionName: "æ„¤æ€’",
    score: 0.88
  },
  sensitiveInfoResult: {
    hasSensitiveInfo: false,
    detectedTypes: []
  },
  entityResult: {
    entities: [
      {
        type: "product",
        text: "iPhone 15",
        confidence: 0.92
      }
    ]
  },
  staffResult: {
    isStaff: false,
    staffId: null,
    matchedStrategies: []
  },
  infoCenterResult: {
    analysisId: "analysis_123",
    saved: true
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹3: FLOW_DECISIONï¼ˆæµç¨‹å†³ç­–ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ”€
- **é¢œè‰²**: #f59e0bï¼ˆæ©™è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
æ ¹æ®æ„å›¾ã€æƒ…ç»ªã€è§„åˆ™ç­‰è¿›è¡Œå†³ç­–ï¼Œç¡®å®šåç»­æµç¨‹åˆ†æ”¯ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… æµç¨‹æ§åˆ¶ï¼ˆæ¡ä»¶åˆ¤æ–­ã€åˆ†æ”¯é€‰æ‹©ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ6ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: æ„å›¾è·¯ç”±
```javascript
{
  actionId: "intent_routing",
  actionName: "æ„å›¾è·¯ç”±",
  enabled: true,
  config: {
    // å†³ç­–æ¨¡å¼
    decisionMode: "priority",        // å†³ç­–æ¨¡å¼ï¼ˆpriority/all/anyï¼‰
    // è·¯ç”±è§„åˆ™
    routes: [
      {
        condition: "intentResult.intent === 'complaint'",
        targetNode: "HUMAN_HANDOVER",
        priority: 1,
        label: "æŠ•è¯‰è½¬äººå·¥"
      },
      {
        condition: "intentResult.intent === 'risk'",
        targetNode: "RISK_HANDLER",
        priority: 2,
        label: "é£é™©å¤„ç†"
      },
      {
        condition: "intentResult.intent === 'spam'",
        targetNode: "FLOW_END",
        priority: 3,
        label: "åƒåœ¾ä¿¡æ¯ç»“æŸ"
      },
      {
        condition: "intentResult.intent === 'conversion'",
        targetNode: "AI_AGENT",
        priority: 4,
        label: "è½¬åŒ–AIå›å¤"
      },
      {
        condition: "intentResult.intent === 'service' || intentResult.intent === 'chat'",
        targetNode: "AI_AGENT",
        priority: 5,
        label: "æœåŠ¡å’¨è¯¢AIå›å¤"
      }
    ],
    // é»˜è®¤åˆ†æ”¯
    defaultRoute: {
      targetNode: "AI_AGENT",
      label: "é»˜è®¤AIå›å¤"
    }
  }
}
```

#### åŠ¨ä½œ2: æƒ…ç»ªè·¯ç”±
```javascript
{
  actionId: "emotion_routing",
  actionName: "æƒ…ç»ªè·¯ç”±",
  enabled: true,
  config: {
    // æƒ…ç»ªé˜ˆå€¼
    emotionThreshold: {
      angry: 0.7,                    // æ„¤æ€’é˜ˆå€¼
      negative: 0.6,                 // è´Ÿé¢æƒ…ç»ªé˜ˆå€¼
      positive: 0.7                  // æ­£é¢æƒ…ç»ªé˜ˆå€¼
    },
    // è·¯ç”±è§„åˆ™
    routes: [
      {
        condition: "emotionResult.emotion === 'angry' && emotionResult.score >= 0.7",
        targetNode: "HUMAN_HANDOVER",
        label: "æ„¤æ€’è½¬äººå·¥"
      },
      {
        condition: "emotionResult.emotion === 'negative' && emotionResult.score >= 0.6",
        targetNode: "STAFF_COOPERATE",
        label: "è´Ÿé¢æƒ…ç»ªååŒ"
      }
    ]
  }
}
```

#### åŠ¨ä½œ3: é£é™©è·¯ç”±
```javascript
{
  actionId: "risk_routing",
  actionName: "é£é™©è·¯ç”±",
  enabled: true,
  config: {
    // é£é™©è§„åˆ™
    riskRules: [
      {
        condition: "sensitiveInfoResult.hasSensitiveInfo === true",
        riskLevel: "critical",
        targetNode: "RISK_HANDLER",
        label: "æ•æ„Ÿä¿¡æ¯é£é™©"
      },
      {
        condition: "intentResult.intent === 'spam'",
        riskLevel: "high",
        targetNode: "FLOW_END",
        label: "åƒåœ¾ä¿¡æ¯"
      },
      {
        condition: "intentResult.intent === 'risk'",
        riskLevel: "high",
        targetNode: "RISK_HANDLER",
        label: "é£é™©å†…å®¹"
      }
    ]
  }
}
```

#### åŠ¨ä½œ4: å·¥ä½œäººå‘˜è·¯ç”±
```javascript
{
  actionId: "staff_routing",
  actionName: "å·¥ä½œäººå‘˜è·¯ç”±",
  enabled: true,
  config: {
    // å·¥ä½œäººå‘˜è¯†åˆ«è·¯ç”±
    staffRoutes: [
      {
        condition: "staffResult.isStaff === true",
        targetNode: "STAFF_COOPERATE",
        label: "å·¥ä½œäººå‘˜æ¶ˆæ¯"
      }
    ]
  }
}
```

#### åŠ¨ä½œ5: è§„åˆ™è·¯ç”±
```javascript
{
  actionId: "rule_routing",
  actionName: "è§„åˆ™è·¯ç”±",
  enabled: true,
  config: {
    // è‡ªå®šä¹‰è§„åˆ™
    customRules: [
      {
        ruleId: "rule_001",
        ruleName: "VIPå®¢æˆ·ä¼˜å…ˆ",
        condition: "message.senderType === 'vip'",
        targetNode: "AI_AGENT",
        priority: 10
      },
      {
        ruleId: "rule_002",
        ruleName: "å·¥ä½œæ—¶é—´",
        condition: "isWorkingHours() === true",
        targetNode: "AI_AGENT",
        priority: 5
      },
      {
        ruleId: "rule_003",
        ruleName: "éå·¥ä½œæ—¶é—´",
        condition: "isWorkingHours() === false",
        targetNode: "FLOW_END",
        priority: 5
      }
    ]
  }
}
```

#### åŠ¨ä½œ6: å†³ç­–ç»“æœè¾“å‡º
```javascript
{
  actionId: "decision_output",
  actionName: "å†³ç­–ç»“æœè¾“å‡º",
  enabled: true,
  config: {
    // è¾“å‡ºå˜é‡
    outputVariables: {
      selectedRoute: "route.label",
      targetNode: "route.targetNode",
      decisionReason: "route.reason",
      confidence: "route.confidence"
    },
    // ä¿å­˜åˆ°ä¸Šä¸‹æ–‡
    saveToContext: true,
    contextKey: "decisionResult"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  decisionResult: {
    selectedRoute: "æŠ•è¯‰è½¬äººå·¥",
    targetNode: "HUMAN_HANDOVER",
    decisionReason: "ç”¨æˆ·æƒ…ç»ªæ„¤æ€’ä¸”æ„å›¾ä¸ºæŠ•è¯‰",
    confidence: 0.95
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹4: AI_AGENTï¼ˆAIä»£ç†ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ¤–
- **é¢œè‰²**: #3b82f6ï¼ˆè“è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
ä½¿ç”¨AIç”Ÿæˆæ™ºèƒ½å›å¤ï¼Œæ”¯æŒè§’è‰²äººè®¾ã€è¯æœ¯æ¨¡æ¿ã€ä¸Šä¸‹æ–‡å†å²ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… AIæ¨¡å—ï¼ˆAIå›å¤ã€è§’è‰²é…ç½®ã€è¯æœ¯æ¨¡æ¿ï¼‰
- âœ… æœºå™¨äººç®¡ç†ï¼ˆæœºå™¨äººçŠ¶æ€ï¼‰
- âœ… å·¥ä½œäººå‘˜è”åŠ¨ï¼ˆå·¥ä½œäººå‘˜è¯†åˆ«ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ8ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: AIå›å¤ç”Ÿæˆ
```javascript
{
  actionId: "ai_reply_generation",
  actionName: "AIå›å¤ç”Ÿæˆ",
  enabled: true,
  config: {
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-32k-service", // æ¨¡å‹IDï¼ˆè±†åŒ…æœåŠ¡å›å¤æ¨¡å‹ï¼‰
    fallbackModelId: "deepseek-v3-conversion", // å¤‡ç”¨æ¨¡å‹ï¼ˆDeepSeekè½¬åŒ–æ¨¡å‹ï¼‰
    // è§’è‰²é…ç½®
    personaId: "service_agent",      // è§’è‰²IDï¼ˆå®¢æœåŠ©æ‰‹ï¼‰
    usePersona: true,                // æ˜¯å¦ä½¿ç”¨è§’è‰²
    // è¯æœ¯æ¨¡æ¿
    templateId: null,                // è¯æœ¯æ¨¡æ¿IDï¼ˆå¯é€‰ï¼‰
    useTemplate: false,              // æ˜¯å¦ä½¿ç”¨è¯æœ¯æ¨¡æ¿
    // æ¸©åº¦å‚æ•°
    temperature: 0.7,                // æ¸©åº¦ï¼ˆ0-2ï¼‰
    // Tokené™åˆ¶
    maxTokens: 1000,                 // æœ€å¤§Tokenæ•°
    // ä¸Šä¸‹æ–‡
    useContextHistory: true,         // æ˜¯å¦ä½¿ç”¨ä¸Šä¸‹æ–‡å†å²
    contextWindowSize: 10,           // ä¸Šä¸‹æ–‡çª—å£å¤§å°
    // æç¤ºè¯
    systemPrompt: "",                // è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯
    useRolePrompt: true,             // æ˜¯å¦ä½¿ç”¨è§’è‰²æç¤ºè¯
    // æ€è€ƒæ¨¡å¼
    enableThinking: false,           // æ˜¯å¦å¯ç”¨æ€è€ƒæ¨¡å¼
    // æµå¼è¾“å‡º
    enableStreaming: true,           // æ˜¯å¦å¯ç”¨æµå¼è¾“å‡º
    // è¾“å‡º
    saveToContext: true,
    contextKey: "aiResponse"
  }
}
```

#### åŠ¨ä½œ2: å·¥ä½œäººå‘˜è”åŠ¨å›å¤
```javascript
{
  actionId: "staff_reply",
  actionName: "å·¥ä½œäººå‘˜è”åŠ¨å›å¤",
  enabled: true,
  config: {
    // å·¥ä½œäººå‘˜è¯†åˆ«
    checkStaffIdentified: true,      // æ˜¯å¦æ£€æŸ¥å·¥ä½œäººå‘˜è¯†åˆ«
    staffIdSource: "context.staffResult.staffId", // å·¥ä½œäººå‘˜IDæ¥æº
    // å·¥ä½œäººå‘˜å›å¤æ¨¡å¼
    staffReplyMode: "notify",        // æ¨¡å¼ï¼ˆnotify/proxy/assistï¼‰
    // é€šçŸ¥é…ç½®
    notifyChannels: ["email", "wechat"], // é€šçŸ¥æ¸ é“
    notifyTemplateId: "staff_notify_template_001", // é€šçŸ¥æ¨¡æ¿
    // ä»£ç†æ¨¡å¼
    proxyReply: true,                // æ˜¯å¦ä»£ç†å›å¤
    proxyMessage: "ã€å·¥ä½œäººå‘˜ã€‘${senderName}: ${content}", // ä»£ç†æ¶ˆæ¯æ ¼å¼
    // è¾…åŠ©æ¨¡å¼
    assistMode: "suggestion",        // è¾…åŠ©æ¨¡å¼ï¼ˆsuggestion/draftï¼‰
    generateSuggestion: true,        // æ˜¯å¦ç”Ÿæˆå›å¤å»ºè®®
    suggestionCount: 3               // å»ºè®®æ•°é‡
  }
}
```

#### åŠ¨ä½œ3: è§’è‰²é…ç½®åŠ è½½
```javascript
{
  actionId: "persona_load",
  actionName: "è§’è‰²é…ç½®åŠ è½½",
  enabled: true,
  config: {
    // è§’è‰²é…ç½®
    personaId: "service_agent",      // è§’è‰²ID
    personaFields: [
      "personaName",                 // è§’è‰²åç§°
      "systemPrompt",                // ç³»ç»Ÿæç¤ºè¯
      "temperature",                 // æ¸©åº¦å‚æ•°
      "maxTokens",                   // æœ€å¤§Tokenæ•°
      "style",                       // å›å¤é£æ ¼
      "behaviorRules"                // è¡Œä¸ºè§„åˆ™
    ],
    // æ•°æ®åº“è¡¨
    tableName: "ai_personas",        // è§’è‰²è¡¨
    // ç‰ˆæœ¬ç®¡ç†
    useVersion: true,                // æ˜¯å¦ä½¿ç”¨ç‰ˆæœ¬
    versionId: "latest",             // ç‰ˆæœ¬ID
    // è¾“å‡º
    saveToContext: true,
    contextKey: "personaConfig"
  }
}
```

#### åŠ¨ä½œ4: è¯æœ¯æ¨¡æ¿åŠ è½½
```javascript
{
  actionId: "template_load",
  actionName: "è¯æœ¯æ¨¡æ¿åŠ è½½",
  enabled: true,
  config: {
    // æ¨¡æ¿é…ç½®
    templateId: null,                // æ¨¡æ¿IDï¼ˆå¯é€‰ï¼‰
    templateCategoryId: "service",   // æ¨¡æ¿åˆ†ç±»ID
    // æ¨¡æ¿å­—æ®µ
    templateFields: [
      "templateName",                // æ¨¡æ¿åç§°
      "templateContent",             // æ¨¡æ¿å†…å®¹
      "variables",                   // å˜é‡åˆ—è¡¨
      "exampleInput",                // ç¤ºä¾‹è¾“å…¥
      "exampleOutput"                // ç¤ºä¾‹è¾“å‡º
    ],
    // æ•°æ®åº“è¡¨
    tableName: "ai_message_templates", // æ¨¡æ¿è¡¨
    // å˜é‡æ›¿æ¢
    enableVariableReplacement: true, // æ˜¯å¦å¯ç”¨å˜é‡æ›¿æ¢
    variableMapping: {
      "{userName}": "message.senderName",
      "{productName}": "entityResult.entities[0].text",
      "{time}": "currentTime()"
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "templateConfig"
  }
}
```

#### åŠ¨ä½œ5: AIè°ƒç”¨ä¼˜åŒ–
```javascript
{
  actionId: "ai_optimization",
  actionName: "AIè°ƒç”¨ä¼˜åŒ–",
  enabled: true,
  config: {
    // ç¼“å­˜é…ç½®
    enableCache: true,               // æ˜¯å¦å¯ç”¨ç¼“å­˜
    cacheTTL: 3600,                  // ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    cacheKey: "ai:${modelId}:${contentHash}", // ç¼“å­˜key
    // é‡è¯•é…ç½®
    enableRetry: true,               // æ˜¯å¦å¯ç”¨é‡è¯•
    retryCount: 3,                   // é‡è¯•æ¬¡æ•°
    retryDelay: 2000,                // é‡è¯•å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
    retryStrategy: "exponential",    // é‡è¯•ç­–ç•¥ï¼ˆfixed/exponentialï¼‰
    // è¶…æ—¶é…ç½®
    timeout: 30000,                  // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    // è´Ÿè½½å‡è¡¡
    enableLoadBalancing: true,       // æ˜¯å¦å¯ç”¨è´Ÿè½½å‡è¡¡
    loadBalancingStrategy: "round_robin", // è´Ÿè½½å‡è¡¡ç­–ç•¥
    // æˆæœ¬ä¼˜åŒ–
    enableCostOptimization: true,    // æ˜¯å¦å¯ç”¨æˆæœ¬ä¼˜åŒ–
    preferCheaperModel: false,       // æ˜¯å¦ä¼˜å…ˆä½¿ç”¨æ›´ä¾¿å®œçš„æ¨¡å‹
    // ç›‘æ§
    enableMetrics: true,             // æ˜¯å¦å¯ç”¨æŒ‡æ ‡ç›‘æ§
    // è¾“å‡º
    saveToContext: true,
    contextKey: "aiOptimization"
  }
}
```

#### åŠ¨ä½œ6: AIè°ƒç”¨è®°å½•
```javascript
{
  actionId: "ai_logging",
  actionName: "AIè°ƒç”¨è®°å½•",
  enabled: true,
  config: {
    // è®°å½•é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "ai_interactions",    // ç›®æ ‡è¡¨
    // è®°å½•å­—æ®µ
    logFields: [
      "interactionId",               // äº¤äº’ID
      "modelId",                     // æ¨¡å‹ID
      "personaId",                   // è§’è‰²ID
      "templateId",                  // æ¨¡æ¿ID
      "input",                       // è¾“å…¥
      "output",                      // è¾“å‡º
      "tokens",                      // Tokenä½¿ç”¨é‡
      "responseTime",                // å“åº”æ—¶é—´
      "cost",                        // æˆæœ¬
      "status",                      // çŠ¶æ€
      "errorMessage",                // é”™è¯¯ä¿¡æ¯
      "timestamp"                    // æ—¶é—´æˆ³
    ],
    // æ€§èƒ½ç›‘æ§
    trackResponseTime: true,         // æ˜¯å¦è¿½è¸ªå“åº”æ—¶é—´
    trackTokenUsage: true,           // æ˜¯å¦è¿½è¸ªTokenä½¿ç”¨é‡
    trackCost: true,                 // æ˜¯å¦è¿½è¸ªæˆæœ¬
    // é”™è¯¯è¿½è¸ª
    trackErrors: true,               // æ˜¯å¦è¿½è¸ªé”™è¯¯
    // è¾“å‡º
    saveToContext: true,
    contextKey: "aiLogging"
  }
}
```

#### åŠ¨ä½œ7: å›å¤è´¨é‡è¯„ä¼°
```javascript
{
  actionId: "reply_quality_evaluation",
  actionName: "å›å¤è´¨é‡è¯„ä¼°",
  enabled: true,
  config: {
    // è¯„ä¼°ç»´åº¦
    evaluationDimensions: [
      {
        dimension: "relevance",
        description: "ç›¸å…³æ€§",
        weight: 0.4
      },
      {
        dimension: "accuracy",
        description: "å‡†ç¡®æ€§",
        weight: 0.3
      },
      {
        dimension: "politeness",
        description: "ç¤¼è²Œæ€§",
        weight: 0.2
      },
      {
        dimension: "helpfulness",
        description: "æœ‰ç”¨æ€§",
        weight: 0.1
      }
    ],
    // è‡ªåŠ¨è¯„ä¼°
    enableAutoEvaluation: true,      // æ˜¯å¦å¯ç”¨è‡ªåŠ¨è¯„ä¼°
    evaluationModelId: "doubao-pro-4k-intent", // è¯„ä¼°æ¨¡å‹
    // äººå·¥è¯„ä¼°
    enableHumanEvaluation: false,    // æ˜¯å¦å¯ç”¨äººå·¥è¯„ä¼°
    // è¾“å‡º
    saveToContext: true,
    contextKey: "replyQuality"
  }
}
```

#### åŠ¨ä½œ8: å¤šæ¨¡å‹æ”¯æŒ
```javascript
{
  actionId: "multi_model_support",
  actionName: "å¤šæ¨¡å‹æ”¯æŒ",
  enabled: true,
  config: {
    // æ”¯æŒçš„AIæä¾›å•†
    supportedProviders: [
      "aliyun_qwen",                 // é˜¿é‡Œäº‘åƒé—®
      "aliyun_qwen_pro",             // é˜¿é‡Œäº‘åƒé—®PRO
      "openai",                      // OpenAI
      "claude",                      // Anthropic Claude
      "deepseek",                    // DeepSeek
      "kimi",                        // Kimi
      "doubao"                       // è±†åŒ…
    ],
    // æ¨¡å‹æ˜ å°„
    modelMapping: {
      "intent_recognition": "doubao-pro-4k-intent",
      "service_reply": "doubao-pro-32k-service",
      "conversion": "deepseek-v3-conversion",
      "tech_support": "deepseek-r1-tech",
      "evaluation": "doubao-pro-4k-intent"
    },
    // æ¨¡å‹åˆ‡æ¢ç­–ç•¥
    switchStrategy: "fallback",      // åˆ‡æ¢ç­–ç•¥ï¼ˆfallback/round_robin/least_loadedï¼‰
    // æ¨¡å‹å¥åº·æ£€æŸ¥
    enableHealthCheck: true,         // æ˜¯å¦å¯ç”¨å¥åº·æ£€æŸ¥
    healthCheckInterval: 60000,      // å¥åº·æ£€æŸ¥é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "multiModel"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  aiResponse: {
    content: "æ‚¨å¥½ï¼Œæˆ‘ç†è§£æ‚¨çš„è¯‰æ±‚ï¼Œè¯·é—®å…·ä½“æ˜¯å“ªä¸ªäº§å“éœ€è¦å”®åå¤„ç†å‘¢ï¼Ÿ",
    model: "doubao-pro-32k-service",
    persona: "service_agent",
    tokens: {
      input: 150,
      output: 80,
      total: 230
    },
    responseTime: 1200,
    cost: 0.0023
  },
  personaConfig: {
    personaId: "service_agent",
    personaName: "å®¢æœåŠ©æ‰‹",
    systemPrompt: "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¢æœåŠ©æ‰‹..."
  },
  templateConfig: null,
  aiOptimization: {
    cached: false,
    retried: false,
    responseTime: 1200
  },
  aiLogging: {
    interactionId: "ai_inter_123",
    saved: true
  },
  replyQuality: {
    overallScore: 0.92,
    dimensions: {
      relevance: 0.95,
      accuracy: 0.90,
      politeness: 0.93,
      helpfulness: 0.90
    }
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹5: RISK_HANDLERï¼ˆé£é™©å¤„ç†ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: âš ï¸
- **é¢œè‰²**: #ef4444ï¼ˆçº¢è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
æ£€æµ‹å’Œå¤„ç†é£é™©æ¶ˆæ¯ï¼ŒåŒ…æ‹¬æ•æ„Ÿå†…å®¹ã€åƒåœ¾ä¿¡æ¯ã€æ”»å‡»æ€§è¨€è®ºç­‰ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… é£é™©ç®¡ç†ï¼ˆé£é™©æ£€æµ‹ã€é£é™©å¤„ç†ï¼‰
- âœ… å‘Šè­¦ç³»ç»Ÿï¼ˆå‘Šè­¦è§¦å‘ï¼‰
- âœ… å·¥ä½œäººå‘˜è”åŠ¨ï¼ˆé€šçŸ¥å·¥ä½œäººå‘˜ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ7ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: é£é™©æ£€æµ‹
```javascript
{
  actionId: "risk_detection",
  actionName: "é£é™©æ£€æµ‹",
  enabled: true,
  config: {
    // é£é™©ç±»å‹
    riskTypes: [
      "sensitive_content",           // æ•æ„Ÿå†…å®¹
      "spam",                        // åƒåœ¾ä¿¡æ¯
      "harassment",                  // éªšæ‰°
      "attack",                      // æ”»å‡»
      "fraud"                        // æ¬ºè¯ˆ
    ],
    // æ£€æµ‹è§„åˆ™
    detectionRules: [
      {
        ruleId: "sensitive_word",
        ruleName: "æ•æ„Ÿè¯æ£€æµ‹",
        detectionMethod: "keyword",  // æ£€æµ‹æ–¹æ³•ï¼ˆkeyword/model/hybridï¼‰
        keywords: [
          "æš´åŠ›",
          "è‰²æƒ…",
          "èµŒåš",
          "è‡ªæ€",
          "ç‚¸å¼¹"
        ],
        threshold: 1                 // åŒ¹é…é˜ˆå€¼
      },
      {
        ruleId: "spam_pattern",
        ruleName: "åƒåœ¾ä¿¡æ¯æ¨¡å¼",
        detectionMethod: "regex",
        pattern: "(å¾®ä¿¡|QQ|ç”µè¯|è”ç³»æ–¹å¼)",
        threshold: 2
      },
      {
        ruleId: "harassment_language",
        ruleName: "éªšæ‰°è¯­è¨€",
        detectionMethod: "model",
        modelId: "doubao-pro-4k-intent",
        threshold: 0.8
      }
    ],
    // æ¨¡å‹é…ç½®
    modelId: "doubao-pro-4k-intent",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "riskDetection"
  }
}
```

#### åŠ¨ä½œ2: é£é™©ç­‰çº§è¯„ä¼°
```javascript
{
  actionId: "risk_level_assessment",
  actionName: "é£é™©ç­‰çº§è¯„ä¼°",
  enabled: true,
  config: {
    // é£é™©ç­‰çº§
    riskLevels: [
      {
        level: "critical",
        levelName: "ä¸¥é‡",
        scoreRange: [0.8, 1.0],
        actions: ["block", "alert_critical", "notify_admin"]
      },
      {
        level: "high",
        levelName: "é«˜",
        scoreRange: [0.6, 0.8],
        actions: ["warn", "alert_high", "notify_staff"]
      },
      {
        level: "medium",
        levelName: "ä¸­",
        scoreRange: [0.4, 0.6],
        actions: ["warn", "alert_medium"]
      },
      {
        level: "low",
        levelName: "ä½",
        scoreRange: [0.0, 0.4],
        actions: ["log"]
      }
    ],
    // è¯„ä¼°æ–¹æ³•
    assessmentMethod: "weighted",    // è¯„ä¼°æ–¹æ³•ï¼ˆweighted/max/minï¼‰
    weights: {
      sensitive_content: 0.4,
      spam: 0.3,
      harassment: 0.2,
      attack: 0.1
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "riskLevel"
  }
}
```

#### åŠ¨ä½œ3: é£é™©å®‰æŠšå›å¤
```javascript
{
  actionId: "risk_soothing",
  actionName: "é£é™©å®‰æŠšå›å¤",
  enabled: true,
  config: {
    // å®‰æŠšç­–ç•¥
    soothingStrategies: [
      {
        strategyId: "empathy",
        strategyName: "å…±æƒ…å®‰æŠš",
        template: "éå¸¸æŠ±æ­‰ç»™æ‚¨å¸¦æ¥ä¸å¥½çš„ä½“éªŒï¼Œæˆ‘ä»¬éå¸¸é‡è§†æ‚¨çš„åé¦ˆï¼Œä¼šå°½å¿«å¤„ç†ã€‚"
      },
      {
        strategyId: "redirect",
        strategyName: "è¯é¢˜è½¬ç§»",
        template: "æ‚¨çš„è¯‰æ±‚æˆ‘ä»¬å·²ç»è®°å½•ï¼Œè¯·é—®è¿˜æœ‰ä»€ä¹ˆå…¶ä»–éœ€è¦å¸®åŠ©çš„å—ï¼Ÿ"
      },
      {
        strategyId: "escalate",
        strategyName: "å‡çº§å¤„ç†",
        template: "æ‚¨çš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å·²ç»å®‰æ’ä¸“äººè·Ÿè¿›ï¼Œç¨åä¼šä¸æ‚¨è”ç³»ã€‚"
      }
    ],
    // æ¨¡å‹ç”Ÿæˆ
    enableAIReply: true,             // æ˜¯å¦å¯ç”¨AIå®‰æŠšå›å¤
    modelId: "doubao-pro-32k-service",
    personaId: "service_agent",
    // å›å¤å†…å®¹
    replyContent: "",                // è‡ªå®šä¹‰å›å¤å†…å®¹ï¼ˆå¯é€‰ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "soothingReply"
  }
}
```

#### åŠ¨ä½œ4: é£é™©å‘Šè­¦è§¦å‘
```javascript
{
  actionId: "risk_alert",
  actionName: "é£é™©å‘Šè­¦è§¦å‘",
  enabled: true,
  config: {
    // å‘Šè­¦é…ç½®
    alertLevels: ["critical", "high", "medium"],
    // å‘Šè­¦è§„åˆ™
    alertRules: [
      {
        ruleId: "risk_alert_001",
        ruleName: "ä¸¥é‡é£é™©å‘Šè­¦",
        condition: "riskLevel.level === 'critical'",
        alertLevel: "critical",
        alertChannels: ["robot", "email", "sms"]
      },
      {
        ruleId: "risk_alert_002",
        ruleName: "é«˜é£é™©å‘Šè­¦",
        condition: "riskLevel.level === 'high'",
        alertLevel: "warning",
        alertChannels: ["robot", "email"]
      }
    ],
    // å‘Šè­¦å†…å®¹æ¨¡æ¿
    alertTemplate: "ã€é£é™©å‘Šè­¦ã€‘æ£€æµ‹åˆ°${riskType}ï¼Œé£é™©ç­‰çº§ï¼š${riskLevel}ï¼Œç”¨æˆ·ï¼š${senderName}",
    // å‘Šè­¦æ¥æ”¶äºº
    alertRecipients: ["admin@company.com", "ops@company.com"],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "riskAlert"
  }
}
```

#### åŠ¨ä½œ5: å·¥ä½œäººå‘˜é€šçŸ¥
```javascript
{
  actionId: "staff_notification",
  actionName: "å·¥ä½œäººå‘˜é€šçŸ¥",
  enabled: true,
  config: {
    // é€šçŸ¥é…ç½®
    notifyOnRisk: true,              // æ˜¯å¦åœ¨é£é™©æ—¶é€šçŸ¥å·¥ä½œäººå‘˜
    notifyRiskLevels: ["critical", "high"], // é€šçŸ¥çš„é£é™©ç­‰çº§
    // é€šçŸ¥æ¸ é“
    notificationChannels: ["email", "wechat", "dingtalk"],
    // é€šçŸ¥æ¨¡æ¿
    notificationTemplate: {
      email: {
        subject: "ã€é£é™©é€šçŸ¥ã€‘ç”¨æˆ·${senderName}å‘é€äº†é£é™©å†…å®¹",
        body: "é£é™©ç±»å‹ï¼š${riskType}\né£é™©ç­‰çº§ï¼š${riskLevel}\næ¶ˆæ¯å†…å®¹ï¼š${content}\næ—¶é—´ï¼š${timestamp}"
      },
      wechat: {
        templateId: "template_risk_notify",
        data: {
          riskType: "${riskType}",
          riskLevel: "${riskLevel}",
          senderName: "${senderName}"
        }
      }
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "staffNotification"
  }
}
```

#### åŠ¨ä½œ6: é£é™©è®°å½•
```javascript
{
  actionId: "risk_logging",
  actionName: "é£é™©è®°å½•",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "risk_records",       // ç›®æ ‡è¡¨
    // è®°å½•å­—æ®µ
    logFields: [
      "riskId",                     // é£é™©ID
      "messageId",                  // æ¶ˆæ¯ID
      "sessionId",                  // ä¼šè¯ID
      "senderId",                   // å‘é€è€…ID
      "senderName",                 // å‘é€è€…åç§°
      "riskType",                   // é£é™©ç±»å‹
      "riskLevel",                  // é£é™©ç­‰çº§
      "riskScore",                  // é£é™©å¾—åˆ†
      "content",                    // å†…å®¹
      "detectionMethod",            // æ£€æµ‹æ–¹æ³•
      "detectionTime",              // æ£€æµ‹æ—¶é—´
      "actionsTaken",               // é‡‡å–çš„è¡ŒåŠ¨
      "status",                     // çŠ¶æ€
      "timestamp"                   // æ—¶é—´æˆ³
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "riskLogging"
  }
}
```

#### åŠ¨ä½œ7: é£é™©å¤„ç†å†³ç­–
```javascript
{
  actionId: "risk_decision",
  actionName: "é£é™©å¤„ç†å†³ç­–",
  enabled: true,
  config: {
    // å¤„ç†ç­–ç•¥
    handlingStrategies: [
      {
        strategyId: "block",
        strategyName: "é˜»æ­¢",
        condition: "riskLevel.level === 'critical'",
        actions: [
          "blockMessage",
          "alertCritical",
          "notifyAdmin"
        ],
        nextNode: "FLOW_END"
      },
      {
        strategyId: "warn_and_reply",
        strategyName: "è­¦å‘Šå¹¶å›å¤",
        condition: "riskLevel.level === 'high'",
        actions: [
          "sendWarning",
          "generateSoothingReply",
          "notifyStaff"
        ],
        nextNode: "MESSAGE_EXIT"
      },
      {
        strategyId: "log_only",
        strategyName: "ä»…è®°å½•",
        condition: "riskLevel.level === 'low' || riskLevel.level === 'medium'",
        actions: [
          "logRisk"
        ],
        nextNode: "FLOW_DECISION"
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "riskDecision"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  riskDetection: {
    detected: true,
    riskTypes: ["harassment"],
    riskScore: 0.85
  },
  riskLevel: {
    level: "high",
    levelName: "é«˜",
    score: 0.85
  },
  soothingReply: {
    content: "éå¸¸æŠ±æ­‰ç»™æ‚¨å¸¦æ¥ä¸å¥½çš„ä½“éªŒï¼Œæˆ‘ä»¬ä¼šè®¤çœŸå¤„ç†æ‚¨çš„åé¦ˆã€‚"
  },
  riskAlert: {
    alertId: "alert_risk_123",
    triggered: true,
    channels: ["robot", "email"]
  },
  staffNotification: {
    sent: true,
    channels: ["email", "wechat"]
  },
  riskLogging: {
    riskId: "risk_123",
    saved: true
  },
  riskDecision: {
    strategy: "warn_and_reply",
    actions: ["sendWarning", "generateSoothingReply", "notifyStaff"],
    nextNode: "MESSAGE_EXIT"
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹6: MESSAGE_EXITï¼ˆæ¶ˆæ¯å‡ºå£ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ“¤
- **é¢œè‰²**: #22c55eï¼ˆé’ç»¿è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
å‘é€æ¶ˆæ¯ç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¶ˆæ¯åˆ†å‘ã€å‘é€ã€çŠ¶æ€è®°å½•ã€ä¼šè¯æ›´æ–°ç­‰ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… æœºå™¨äººç®¡ç†ï¼ˆæ¶ˆæ¯å‘é€ï¼‰
- âœ… æœºå™¨äººç®¡ç†ï¼ˆä¼ä¸šå¾®ä¿¡å®˜æ–¹æœºå™¨äººã€è‡ªå®šä¹‰æœºå™¨äººï¼‰
- âœ… æ¶ˆæ¯ä¸­å¿ƒï¼ˆæ¶ˆæ¯çŠ¶æ€æ›´æ–°ï¼‰
- âœ… ä¼šè¯ç®¡ç†ï¼ˆä¼šè¯æ›´æ–°ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ8ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: æ¶ˆæ¯åˆ†å‘å†³ç­–
```javascript
{
  actionId: "message_dispatch",
  actionName: "æ¶ˆæ¯åˆ†å‘å†³ç­–",
  enabled: true,
  config: {
    // åˆ†å‘æ¨¡å¼
    dispatchMode: "auto",            // åˆ†å‘æ¨¡å¼ï¼ˆauto/single/broadcastï¼‰
    // åˆ†å‘å†³ç­–
    dispatchRules: [
      {
        ruleId: "dispatch_001",
        ruleName: "ç¾¤èŠåˆ†å‘",
        condition: "message.roomType === 'group'",
        dispatchType: "group",
        targetSource: "message.groupChatId"
      },
      {
        ruleId: "dispatch_002",
        ruleName: "ç§èŠåˆ†å‘",
        condition: "message.roomType === 'private'",
        dispatchType: "private",
        targetSource: "message.senderName"
      }
    ],
    // ç¾¤å‘é…ç½®
    broadcastConfig: {
      enabled: false,                 // æ˜¯å¦å¯ç”¨ç¾¤å‘
      targets: [],                   // ç›®æ ‡åˆ—è¡¨
      batchSize: 10,                 // æ‰¹é‡å¤§å°
      delayBetweenBatches: 1000      // æ‰¹æ¬¡é—´å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "dispatchResult"
  }
}
```

#### åŠ¨ä½œ2: ä¼ä¸šå¾®ä¿¡å®˜æ–¹æœºå™¨äººå‘é€
```javascript
{
  actionId: "official_robot_send",
  actionName: "ä¼ä¸šå¾®ä¿¡å®˜æ–¹æœºå™¨äººå‘é€",
  enabled: true,
  config: {
    // æœºå™¨äººé…ç½®
    robotType: "official",           // æœºå™¨äººç±»å‹
    // Webhookåœ°å€
    webhookUrlTemplate: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key={webhookKey}",
    webhookKeySource: "robot.webhookKey", // Webhook keyæ¥æº
    // æ¶ˆæ¯ç±»å‹
    messageType: "text",             // æ¶ˆæ¯ç±»å‹ï¼ˆtext/markdown/image/file/newsï¼‰
    // æ¶ˆæ¯å†…å®¹
    messageContentSource: "aiResponse.content", // æ¶ˆæ¯å†…å®¹æ¥æº
    // @äººé…ç½®
    enableAtList: true,              // æ˜¯å¦å¯ç”¨@äºº
    atListSource: "message.atList",  // @äººåˆ—è¡¨æ¥æº
    atAll: false,                    // æ˜¯å¦@æ‰€æœ‰äºº
    mentionedList: [],               // @äººåˆ—è¡¨ï¼ˆç”¨æˆ·IDï¼‰
    mentionedMobileList: [],         // @äººåˆ—è¡¨ï¼ˆæ‰‹æœºå·ï¼‰
    // Markdowné…ç½®ï¼ˆå¦‚æœmessageTypeæ˜¯markdownï¼‰
    markdownConfig: {
      enableMarkdown: false,         // æ˜¯å¦å¯ç”¨Markdown
      markdownContent: ""            // Markdownå†…å®¹
    },
    // å›¾ç‰‡é…ç½®ï¼ˆå¦‚æœmessageTypeæ˜¯imageï¼‰
    imageConfig: {
      imageUrl: "",                  // å›¾ç‰‡URL
      base64: "",                    // Base64ç¼–ç 
      md5: ""                        // MD5å€¼
    },
    // å›¾æ–‡é…ç½®ï¼ˆå¦‚æœmessageTypeæ˜¯newsï¼‰
    newsConfig: {
      articles: [                    // å›¾æ–‡åˆ—è¡¨
        {
          title: "",
          description: "",
          url: "",
          picurl: ""
        }
      ]
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "officialRobotSendResult"
  }
}
```

#### åŠ¨ä½œ3: è‡ªå®šä¹‰æœºå™¨äººå‘é€
```javascript
{
  actionId: "custom_robot_send",
  actionName: "è‡ªå®šä¹‰æœºå™¨äººå‘é€",
  enabled: true,
  config: {
    // æœºå™¨äººé…ç½®
    robotType: "custom",             // æœºå™¨äººç±»å‹
    // APIåœ°å€
    apiEndpointTemplate: "https://api.worktool.com/robot/{robotId}/send",
    robotIdSource: "message.robotId", // æœºå™¨äººIDæ¥æº
    // è®¤è¯
    authMethod: "api_key",           // è®¤è¯æ–¹æ³•ï¼ˆapi_key/token/oauthï¼‰
    authKeySource: "robot.robotSecret", // è®¤è¯keyæ¥æº
    // æ¶ˆæ¯ç±»å‹
    messageType: "text",             // æ¶ˆæ¯ç±»å‹
    // æ¶ˆæ¯å†…å®¹
    messageContentSource: "aiResponse.content",
    // æ¥æ”¶è€…
    recipients: [],                  // æ¥æ”¶è€…åˆ—è¡¨
    recipientsSource: "message.senderName", // æ¥æ”¶è€…æ¥æº
    // @äººé…ç½®
    enableAtList: true,
    atListSource: "message.atList",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "customRobotSendResult"
  }
}
```

#### åŠ¨ä½œ4: æ¶ˆæ¯å‘é€é‡è¯•
```javascript
{
  actionId: "send_retry",
  actionName: "æ¶ˆæ¯å‘é€é‡è¯•",
  enabled: true,
  config: {
    // é‡è¯•é…ç½®
    enableRetry: true,               // æ˜¯å¦å¯ç”¨é‡è¯•
    retryCount: 3,                   // é‡è¯•æ¬¡æ•°
    retryDelay: 2000,                // é‡è¯•å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
    retryStrategy: "exponential",    // é‡è¯•ç­–ç•¥ï¼ˆfixed/exponential/backoffï¼‰
    // é‡è¯•æ¡ä»¶
    retryConditions: [
      {
        condition: "response.statusCode === 500",
        action: "retry"
      },
      {
        condition: "response.statusCode === 429",
        action: "retry_with_backoff"
      },
      {
        condition: "response.statusCode === 403",
        action: "no_retry"
      }
    ],
    // é€€é¿ç­–ç•¥
    backoffConfig: {
      initialDelay: 2000,            // åˆå§‹å»¶è¿Ÿ
      maxDelay: 30000,               // æœ€å¤§å»¶è¿Ÿ
      backoffFactor: 2               // é€€é¿å› å­
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "retryResult"
  }
}
```

#### åŠ¨ä½œ5: æ¶ˆæ¯ä¼˜å…ˆçº§ä¸è´Ÿè½½å‡è¡¡
```javascript
{
  actionId: "priority_and_load_balancing",
  actionName: "æ¶ˆæ¯ä¼˜å…ˆçº§ä¸è´Ÿè½½å‡è¡¡",
  enabled: true,
  config: {
    // ä¼˜å…ˆçº§é…ç½®
    enablePriority: true,            // æ˜¯å¦å¯ç”¨ä¼˜å…ˆçº§
    priorityLevels: {
      critical: 1,                   // ä¸¥é‡ä¼˜å…ˆçº§
      high: 2,                       // é«˜ä¼˜å…ˆçº§
      normal: 3,                     // æ™®é€šä¼˜å…ˆçº§
      low: 4                         // ä½ä¼˜å…ˆçº§
    },
    priorityRules: [
      {
        ruleId: "priority_001",
        ruleName: "é£é™©æ¶ˆæ¯é«˜ä¼˜å…ˆçº§",
        condition: "riskLevel.level === 'critical'",
        priority: "critical"
      },
      {
        ruleId: "priority_002",
        ruleName: "æ™®é€šæ¶ˆæ¯æ™®é€šä¼˜å…ˆçº§",
        condition: "intentResult.intent === 'service'",
        priority: "normal"
      }
    ],
    // è´Ÿè½½å‡è¡¡é…ç½®
    enableLoadBalancing: true,       // æ˜¯å¦å¯ç”¨è´Ÿè½½å‡è¡¡
    loadBalancingStrategy: "round_robin", // è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆround_robin/least_loaded/weightedï¼‰
    weightedRobots: [                // åŠ æƒæœºå™¨äººé…ç½®
      {
        robotId: "robot_001",
        weight: 3
      },
      {
        robotId: "robot_002",
        weight: 2
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "priorityAndLoadBalancing"
  }
}
```

#### åŠ¨ä½œ6: æ¶ˆæ¯çŠ¶æ€è®°å½•
```javascript
{
  actionId: "message_status_record",
  actionName: "æ¶ˆæ¯çŠ¶æ€è®°å½•",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "message_status",     // ç›®æ ‡è¡¨
    // è®°å½•å­—æ®µ
    logFields: [
      "statusId",                   // çŠ¶æ€ID
      "messageId",                  // æ¶ˆæ¯ID
      "sessionId",                  // ä¼šè¯ID
      "robotId",                    // æœºå™¨äººID
      "robotType",                  // æœºå™¨äººç±»å‹
      "status",                     // çŠ¶æ€ï¼ˆsending/sent/failedï¼‰
      "recipient",                  // æ¥æ”¶è€…
      "messageType",                // æ¶ˆæ¯ç±»å‹
      "content",                    // å†…å®¹
      "sentAt",                     // å‘é€æ—¶é—´
      "responseCode",               // å“åº”ç 
      "responseMessage",            // å“åº”æ¶ˆæ¯
      "retryCount",                 // é‡è¯•æ¬¡æ•°
      "errorMessage",               // é”™è¯¯ä¿¡æ¯
      "timestamp"                   // æ—¶é—´æˆ³
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "messageStatusRecord"
  }
}
```

#### åŠ¨ä½œ7: ä¼šè¯æ›´æ–°
```javascript
{
  actionId: "session_update",
  actionName: "ä¼šè¯æ›´æ–°",
  enabled: true,
  config: {
    // æ›´æ–°é…ç½®
    updateSession: true,             // æ˜¯å¦æ›´æ–°ä¼šè¯
    tableName: "sessions",           // ç›®æ ‡è¡¨
    // æ›´æ–°å­—æ®µ
    updateFields: [
      "lastMessageTime",            // æœ€åæ¶ˆæ¯æ—¶é—´
      "messageCount",               // æ¶ˆæ¯è®¡æ•°
      "lastAIReply",                // æœ€åAIå›å¤
      "status"                      // çŠ¶æ€
    ],
    // æ‰¹é‡æ›´æ–°
    batchUpdate: true,              // æ˜¯å¦æ‰¹é‡æ›´æ–°ï¼ˆç”¨æˆ·æ¶ˆæ¯+AIå›å¤ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "sessionUpdate"
  }
}
```

#### åŠ¨ä½œ8: WebSocketå®æ—¶æ¨é€
```javascript
{
  actionId: "websocket_push",
  actionName: "WebSocketå®æ—¶æ¨é€",
  enabled: true,
  config: {
    // æ¨é€é…ç½®
    enablePush: true,                // æ˜¯å¦å¯ç”¨æ¨é€
    // æ¨é€ç›®æ ‡
    pushTargets: [
      "panel1",                     // ä¸šåŠ¡æ¶ˆæ¯ç›‘æ§é¢æ¿
      "panel2"                      // AIäº¤äº’ç›‘æ§é¢æ¿
    ],
    // æ¨é€æ•°æ®
    pushData: {
      messageId: "message.messageId",
      sessionId: "message.sessionId",
      senderName: "message.senderName",
      content: "message.content",
      aiReply: "aiResponse.content",
      status: "sent",
      timestamp: "currentTime()"
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "websocketPush"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  dispatchResult: {
    dispatchType: "private",
    targetName: "å¼ ä¸‰"
  },
  officialRobotSendResult: {
    sent: true,
    responseCode: 200,
    responseBody: "{\"errcode\":0,\"errmsg\":\"ok\"}"
  },
  customRobotSendResult: {
    sent: false,
    reason: "Not a custom robot"
  },
  retryResult: {
    retried: false,
    retryCount: 0
  },
  priorityAndLoadBalancing: {
    priority: "normal",
    selectedRobot: "robot_001"
  },
  messageStatusRecord: {
    statusId: "status_123",
    saved: true
  },
  sessionUpdate: {
    sessionId: "sess_789012",
    updated: true,
    messageCount: 2
  },
  websocketPush: {
    pushed: true,
    targets: ["panel1", "panel2"]
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹7: SMART_MONITORï¼ˆæ™ºèƒ½ç›‘æ§ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ“Š
- **é¢œè‰²**: #06b6d4ï¼ˆé’è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
å®æ—¶ç›‘æ§ç¾¤å†…æ¶ˆæ¯ã€æ£€æµ‹å¼‚å¸¸è¡Œä¸ºã€è®°å½•ç»Ÿè®¡æ•°æ®ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… ç›‘æ§ç³»ç»Ÿï¼ˆå®æ—¶ç›‘æ§ï¼‰
- âœ… ä¿¡æ¯ä¸­å¿ƒï¼ˆæ¶ˆæ¯ç»Ÿè®¡ï¼‰
- âœ… ååŒç³»ç»Ÿï¼ˆååŒç›‘æ§ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ6ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: å®æ—¶æ¶ˆæ¯ç›‘æ§
```javascript
{
  actionId: "realtime_monitoring",
  actionName: "å®æ—¶æ¶ˆæ¯ç›‘æ§",
  enabled: true,
  config: {
    // ç›‘æ§é…ç½®
    enableMonitoring: true,          // æ˜¯å¦å¯ç”¨ç›‘æ§
    // ç›‘æ§ç›®æ ‡
    monitorTargets: [
      {
        targetId: "group_001",
        targetName: "å®¢æˆ·ç¾¤",
        targetType: "group"
      },
      {
        targetId: "private_001",
        targetName: "é‡è¦å®¢æˆ·",
        targetType: "private"
      }
    ],
    // ç›‘æ§ç±»å‹
    monitorTypes: [
      "message",                     // æ¶ˆæ¯ç›‘æ§
      "member",                      // æˆå‘˜ç›‘æ§
      "activity"                     // æ´»åŠ¨ç›‘æ§
    ],
    // ç›‘æ§é¢‘ç‡
    monitoringInterval: 5000,        // ç›‘æ§é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "realtimeMonitoring"
  }
}
```

#### åŠ¨ä½œ2: å¼‚å¸¸æ£€æµ‹
```javascript
{
  actionId: "anomaly_detection",
  actionName: "å¼‚å¸¸æ£€æµ‹",
  enabled: true,
  config: {
    // å¼‚å¸¸ç±»å‹
    anomalyTypes: [
      "spam_flood",                  // åƒåœ¾ä¿¡æ¯æ´ªæ°´
      "member_suspicious",           // æˆå‘˜å¯ç–‘è¡Œä¸º
      "unusual_pattern",             // å¼‚å¸¸æ¨¡å¼
      "system_error"                 // ç³»ç»Ÿé”™è¯¯
    ],
    // æ£€æµ‹è§„åˆ™
    detectionRules: [
      {
        ruleId: "spam_flood_001",
        ruleName: "åƒåœ¾ä¿¡æ¯æ´ªæ°´æ£€æµ‹",
        condition: "messageCount > 10 && spamRatio > 0.8",
        threshold: 10,                // æ¶ˆæ¯æ•°é˜ˆå€¼
        timeWindow: 60000            // æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰
      },
      {
        ruleId: "member_suspicious_001",
        ruleName: "æˆå‘˜å¯ç–‘è¡Œä¸ºæ£€æµ‹",
        condition: "newMemberCount > 5 && suspiciousActivityRatio > 0.6",
        threshold: 5,                 // æ–°æˆå‘˜æ•°é˜ˆå€¼
        timeWindow: 300000           // æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰
      }
    ],
    // æ¨¡å‹æ£€æµ‹
    enableModelDetection: true,      // æ˜¯å¦å¯ç”¨æ¨¡å‹æ£€æµ‹
    modelId: "doubao-pro-4k-intent",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "anomalyDetection"
  }
}
```

#### åŠ¨ä½œ3: æ€§èƒ½ç›‘æ§
```javascript
{
  actionId: "performance_monitoring",
  actionName: "æ€§èƒ½ç›‘æ§",
  enabled: true,
  config: {
    // ç›‘æ§æŒ‡æ ‡
    metrics: [
      {
        metricId: "response_time",
        metricName: "å“åº”æ—¶é—´",
        unit: "ms",
        threshold: 5000,             // é˜ˆå€¼
        alertLevel: "warning"
      },
      {
        metricId: "success_rate",
        metricName: "æˆåŠŸç‡",
        unit: "%",
        threshold: 95,               // é˜ˆå€¼
        alertLevel: "critical"
      },
      {
        metricId: "throughput",
        metricName: "ååé‡",
        unit: "msg/min",
        threshold: 100,              // é˜ˆå€¼
        alertLevel: "info"
      },
      {
        metricId: "error_rate",
        metricName: "é”™è¯¯ç‡",
        unit: "%",
        threshold: 5,                // é˜ˆå€¼
        alertLevel: "warning"
      }
    ],
    // ç»Ÿè®¡å‘¨æœŸ
    statisticsInterval: 60000,       // ç»Ÿè®¡é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "performanceMonitoring"
  }
}
```

#### åŠ¨ä½œ4: ç»Ÿè®¡æ•°æ®è®°å½•
```javascript
{
  actionId: "statistics_logging",
  actionName: "ç»Ÿè®¡æ•°æ®è®°å½•",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "monitoring_statistics", // ç›®æ ‡è¡¨
    // ç»Ÿè®¡ç»´åº¦
    statisticsDimensions: [
      "date",                        // æ—¥æœŸ
      "hour",                        // å°æ—¶
      "groupId",                     // ç¾¤ç»„ID
      "robotId",                     // æœºå™¨äººID
      "intent",                      // æ„å›¾
      "emotion"                      // æƒ…ç»ª
    ],
    // ç»Ÿè®¡æŒ‡æ ‡
    statisticsMetrics: [
      "messageCount",                // æ¶ˆæ¯æ•°
      "sessionCount",                // ä¼šè¯æ•°
      "userCount",                   // ç”¨æˆ·æ•°
      "aiResponseCount",             // AIå›å¤æ•°
      "humanInterventionCount",      // äººå·¥å¹²é¢„æ•°
      "averageResponseTime",         // å¹³å‡å“åº”æ—¶é—´
      "successRate",                 // æˆåŠŸç‡
      "errorRate"                    // é”™è¯¯ç‡
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "statisticsLogging"
  }
}
```

#### åŠ¨ä½œ5: ååŒç›‘æ§
```javascript
{
  actionId: "collaboration_monitoring",
  actionName: "ååŒç›‘æ§",
  enabled: true,
  config: {
    // ååŒç›‘æ§é…ç½®
    enableCollaboration: true,       // æ˜¯å¦å¯ç”¨ååŒç›‘æ§
    // å·¥ä½œäººå‘˜æ´»åŠ¨ç›‘æ§
    monitorStaffActivity: true,      // æ˜¯å¦ç›‘æ§å·¥ä½œäººå‘˜æ´»åŠ¨
    activityTypes: [
      "message_read",                // æ¶ˆæ¯é˜…è¯»
      "message_reply",               // æ¶ˆæ¯å›å¤
      "task_assigned",               // ä»»åŠ¡åˆ†é…
      "task_completed"               // ä»»åŠ¡å®Œæˆ
    ],
    // å·¥ä½œäººå‘˜çŠ¶æ€
    trackStaffStatus: true,          // æ˜¯å¦è¿½è¸ªå·¥ä½œäººå‘˜çŠ¶æ€
    statusTypes: [
      "online",                      // åœ¨çº¿
      "busy",                        // å¿™ç¢Œ
      "offline",                     // ç¦»çº¿
      "away"                         // ç¦»å¼€
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "collaborationMonitoring"
  }
}
```

#### åŠ¨ä½œ6: ç›‘æ§å‘Šè­¦
```javascript
{
  actionId: "monitoring_alert",
  actionName: "ç›‘æ§å‘Šè­¦",
  enabled: true,
  config: {
    // å‘Šè­¦é…ç½®
    enableAlert: true,               // æ˜¯å¦å¯ç”¨å‘Šè­¦
    // å‘Šè­¦è§„åˆ™
    alertRules: [
      {
        ruleId: "monitor_alert_001",
        ruleName: "å“åº”æ—¶é—´è¿‡é•¿",
        condition: "performanceMonitoring.responseTime > 5000",
        alertLevel: "warning",
        alertChannels: ["robot"]
      },
      {
        ruleId: "monitor_alert_002",
        ruleName: "æˆåŠŸç‡è¿‡ä½",
        condition: "performanceMonitoring.successRate < 95",
        alertLevel: "critical",
        alertChannels: ["robot", "email"]
      },
      {
        ruleId: "monitor_alert_003",
        ruleName: "æ£€æµ‹åˆ°å¼‚å¸¸è¡Œä¸º",
        condition: "anomalyDetection.detected === true",
        alertLevel: "high",
        alertChannels: ["robot", "email", "wechat"]
      }
    ],
    // å‘Šè­¦å†…å®¹æ¨¡æ¿
    alertTemplate: "ã€ç›‘æ§å‘Šè­¦ã€‘${metricName}: ${metricValue}${unit}ï¼Œè¶…è¿‡é˜ˆå€¼${threshold}",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "monitoringAlert"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  realtimeMonitoring: {
    monitoring: true,
    targets: 2,
    messages: 10
  },
  anomalyDetection: {
    detected: false,
    anomalies: []
  },
  performanceMonitoring: {
    responseTime: 1200,
    successRate: 98,
    throughput: 80,
    errorRate: 2
  },
  statisticsLogging: {
    statisticsId: "stats_123",
    saved: true
  },
  collaborationMonitoring: {
    onlineStaff: 5,
    activeTasks: 3
  },
  monitoringAlert: {
    triggered: false
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹8: ALERT_ESCALATIONï¼ˆå‘Šè­¦å‡çº§ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ””
- **é¢œè‰²**: #f97316ï¼ˆæ©™è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
ç®¡ç†å‘Šè­¦çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬å‘Šè­¦å…¥åº“ã€è§„åˆ™åˆ¤æ–­ã€å‡çº§å¤„ç†ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… å‘Šè­¦ç³»ç»Ÿï¼ˆå‘Šè­¦ç®¡ç†ï¼‰
- âœ… å·¥ä½œäººå‘˜è”åŠ¨ï¼ˆå‘Šè­¦é€šçŸ¥ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ7ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: å‘Šè­¦å…¥åº“
```javascript
{
  actionId: "alert_save",
  actionName: "å‘Šè­¦å…¥åº“",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "alert_history",      // ç›®æ ‡è¡¨
    // å‘Šè­¦å­—æ®µ
    alertFields: [
      "alertId",                    // å‘Šè­¦ID
      "messageId",                  // æ¶ˆæ¯ID
      "sessionId",                  // ä¼šè¯ID
      "senderId",                   // å‘é€è€…ID
      "senderName",                 // å‘é€è€…åç§°
      "alertLevel",                 // å‘Šè­¦çº§åˆ«
      "alertType",                  // å‘Šè­¦ç±»å‹
      "alertMessage",               // å‘Šè­¦æ¶ˆæ¯
      "alertSource",                // å‘Šè­¦æ¥æº
      "status",                     // çŠ¶æ€
      "priority",                   // ä¼˜å…ˆçº§
      "escalationLevel",            // å‡çº§çº§åˆ«
      "assignedTo",                 // åˆ†é…ç»™
      "resolvedBy",                 // è§£å†³è€…
      "resolution",                 // è§£å†³æ–¹æ¡ˆ
      "createdAt",                  // åˆ›å»ºæ—¶é—´
      "updatedAt",                  // æ›´æ–°æ—¶é—´
      "resolvedAt",                 // è§£å†³æ—¶é—´
      "metadata"                    // å…ƒæ•°æ®
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertSave"
  }
}
```

#### åŠ¨ä½œ2: å‘Šè­¦è§„åˆ™åˆ¤æ–­
```javascript
{
  actionId: "alert_rule_judgment",
  actionName: "å‘Šè­¦è§„åˆ™åˆ¤æ–­",
  enabled: true,
  config: {
    // è§„åˆ™é…ç½®
    enableRuleJudgment: true,        // æ˜¯å¦å¯ç”¨è§„åˆ™åˆ¤æ–­
    // è§„åˆ™åˆ—è¡¨
    rules: [
      {
        ruleId: "alert_rule_001",
        ruleName: "ä¸¥é‡å‘Šè­¦è§„åˆ™",
        condition: "alertLevel === 'critical'",
        alertLevel: "critical",
        actions: [
          "escalate_immediately",
          "notify_admin",
          "assign_to_manager"
        ],
        escalationLevel: 3
      },
      {
        ruleId: "alert_rule_002",
        ruleName: "è­¦å‘Šå‘Šè­¦è§„åˆ™",
        condition: "alertLevel === 'warning'",
        alertLevel: "warning",
        actions: [
          "escalate_after_timeout",
          "notify_staff"
        ],
        escalationLevel: 2,
        escalationTimeout: 1800000   // å‡çº§è¶…æ—¶ï¼ˆæ¯«ç§’ï¼Œ30åˆ†é’Ÿï¼‰
      },
      {
        ruleId: "alert_rule_003",
        ruleName: "ä¿¡æ¯å‘Šè­¦è§„åˆ™",
        condition: "alertLevel === 'info'",
        alertLevel: "info",
        actions: [
          "log_only"
        ],
        escalationLevel: 1
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertRuleJudgment"
  }
}
```

#### åŠ¨ä½œ3: å‘Šè­¦å‡çº§å¤„ç†
```javascript
{
  actionId: "alert_escalation",
  actionName: "å‘Šè­¦å‡çº§å¤„ç†",
  enabled: true,
  config: {
    // å‡çº§é…ç½®
    enableEscalation: true,          // æ˜¯å¦å¯ç”¨å‡çº§
    // å‡çº§ç­–ç•¥
    escalationStrategies: [
      {
        strategyId: "time_based",
        strategyName: "åŸºäºæ—¶é—´",
        rules: [
          {
            fromLevel: 1,
            toLevel: 2,
            timeout: 1800000,        // 30åˆ†é’Ÿ
            actions: ["notify_staff"]
          },
          {
            fromLevel: 2,
            toLevel: 3,
            timeout: 3600000,        // 1å°æ—¶
            actions: ["notify_manager", "call_phone"]
          }
        ]
      },
      {
        strategyId: "condition_based",
        strategyName: "åŸºäºæ¡ä»¶",
        rules: [
          {
            condition: "alertLevel === 'critical'",
            fromLevel: 1,
            toLevel: 3,
            actions: ["escalate_immediately", "notify_admin"]
          }
        ]
      }
    ],
    // æœ€å¤§å‡çº§çº§åˆ«
    maxEscalationLevel: 3,
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertEscalation"
  }
}
```

#### åŠ¨ä½œ4: å‘Šè­¦é€šçŸ¥
```javascript
{
  actionId: "alert_notification",
  actionName: "å‘Šè­¦é€šçŸ¥",
  enabled: true,
  config: {
    // é€šçŸ¥é…ç½®
    enableNotification: true,       // æ˜¯å¦å¯ç”¨é€šçŸ¥
    // é€šçŸ¥æ¸ é“
    notificationChannels: {
      robot: {
        enabled: true,
        robotId: "alert_robot_001",
        messageTemplate: "ã€å‘Šè­¦é€šçŸ¥ã€‘${alertMessage}"
      },
      email: {
        enabled: true,
        recipients: ["admin@company.com"],
        subjectTemplate: "ã€å‘Šè­¦ã€‘${alertType} - ${alertLevel}",
        bodyTemplate: "å‘Šè­¦æ¶ˆæ¯ï¼š${alertMessage}\nå‘Šè­¦çº§åˆ«ï¼š${alertLevel}\næ—¶é—´ï¼š${timestamp}"
      },
      sms: {
        enabled: false,
        recipients: [],
        messageTemplate: "ã€å‘Šè­¦ã€‘${alertMessage}"
      },
      wechat: {
        enabled: true,
        templateId: "template_alert_notify",
        data: {
          alertType: "${alertType}",
          alertLevel: "${alertLevel}",
          alertMessage: "${alertMessage}"
        }
      },
      dingtalk: {
        enabled: false,
        webhookUrl: "",
        messageTemplate: "ã€å‘Šè­¦ã€‘${alertMessage}"
      }
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertNotification"
  }
}
```

#### åŠ¨ä½œ5: å‘Šè­¦åˆ†é…
```javascript
{
  actionId: "alert_assignment",
  actionName: "å‘Šè­¦åˆ†é…",
  enabled: true,
  config: {
    // åˆ†é…é…ç½®
    enableAssignment: true,          // æ˜¯å¦å¯ç”¨åˆ†é…
    // åˆ†é…ç­–ç•¥
    assignmentStrategies: [
      {
        strategyId: "round_robin",
        strategyName: "è½®è¯¢åˆ†é…",
        enabled: true
      },
      {
        strategyId: "workload_based",
        strategyName: "åŸºäºå·¥ä½œé‡",
        enabled: true,
        metrics: ["activeAlerts", "resolutionTime"]
      },
      {
        strategyId: "skill_based",
        strategyName: "åŸºäºæŠ€èƒ½",
        enabled: true,
        skillMatching: {
          critical: ["manager"],
          warning: ["supervisor"],
          info: ["staff"]
        }
      }
    ],
    // å·¥ä½œäººå‘˜åˆ—è¡¨
    availableStaff: [
      {
        staffId: "staff_001",
        staffName: "å¼ ä¸‰",
        role: "manager",
        workload: 2
      },
      {
        staffId: "staff_002",
        staffName: "æå››",
        role: "supervisor",
        workload: 3
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertAssignment"
  }
}
```

#### åŠ¨ä½œ6: å‘Šè­¦çŠ¶æ€æ›´æ–°
```javascript
{
  actionId: "alert_status_update",
  actionName: "å‘Šè­¦çŠ¶æ€æ›´æ–°",
  enabled: true,
  config: {
    // çŠ¶æ€æµè½¬
    statusTransitions: [
      {
        fromStatus: "pending",
        toStatus: "assigned",
        trigger: "assignment"
      },
      {
        fromStatus: "assigned",
        toStatus: "in_progress",
        trigger: "accept"
      },
      {
        fromStatus: "in_progress",
        toStatus: "resolved",
        trigger: "resolution"
      },
      {
        fromStatus: "pending",
        toStatus: "ignored",
        trigger: "ignore"
      },
      {
        fromStatus: "in_progress",
        toStatus: "escalated",
        trigger: "escalation"
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertStatusUpdate"
  }
}
```

#### åŠ¨ä½œ7: å‘Šè­¦ç»Ÿè®¡
```javascript
{
  actionId: "alert_statistics",
  actionName: "å‘Šè­¦ç»Ÿè®¡",
  enabled: true,
  config: {
    // ç»Ÿè®¡ç»´åº¦
    statisticsDimensions: [
      "date",                        // æ—¥æœŸ
      "hour",                        // å°æ—¶
      "alertLevel",                  // å‘Šè­¦çº§åˆ«
      "alertType",                   // å‘Šè­¦ç±»å‹
      "groupId",                     // ç¾¤ç»„ID
      "assignedTo"                   // åˆ†é…ç»™
    ],
    // ç»Ÿè®¡æŒ‡æ ‡
    statisticsMetrics: [
      "totalAlerts",                 // æ€»å‘Šè­¦æ•°
      "pendingAlerts",               // å¾…å¤„ç†å‘Šè­¦æ•°
      "assignedAlerts",              // å·²åˆ†é…å‘Šè­¦æ•°
      "inProgressAlerts",            // å¤„ç†ä¸­å‘Šè­¦æ•°
      "resolvedAlerts",              // å·²è§£å†³å‘Šè­¦æ•°
      "ignoredAlerts",               // å·²å¿½ç•¥å‘Šè­¦æ•°
      "escalatedAlerts",             // å·²å‡çº§å‘Šè­¦æ•°
      "averageResolutionTime",       // å¹³å‡è§£å†³æ—¶é—´
      "averageEscalationTime"        // å¹³å‡å‡çº§æ—¶é—´
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "alertStatistics"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  alertSave: {
    alertId: "alert_123",
    saved: true
  },
  alertRuleJudgment: {
    matchedRule: "alert_rule_002",
    actions: ["escalate_after_timeout", "notify_staff"]
  },
  alertEscalation: {
    escalated: false,
    currentLevel: 2,
    maxLevel: 3
  },
  alertNotification: {
    sent: true,
    channels: ["robot", "email"]
  },
  alertAssignment: {
    assigned: true,
    assignedTo: "staff_002"
  },
  alertStatusUpdate: {
    status: "assigned",
    previousStatus: "pending"
  },
  alertStatistics: {
    totalAlerts: 100,
    pendingAlerts: 5,
    assignedAlerts: 10,
    resolvedAlerts: 80,
    averageResolutionTime: 3600
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹9: HUMAN_HANDOVERï¼ˆäººå·¥æ¥ç®¡ï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: ğŸ‘¥
- **é¢œè‰²**: #8b5cf6ï¼ˆç´«è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
è½¬äººå·¥å®¢æœå¤„ç†ï¼ŒåŒ…æ‹¬ä»»åŠ¡åˆ†é…ã€é€šçŸ¥ã€ååŒç­‰ã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… ååŒç³»ç»Ÿï¼ˆå·¥ä½œäººå‘˜ä»‹å…¥ï¼‰
- âœ… ä»»åŠ¡ç®¡ç†ï¼ˆä»»åŠ¡åˆ†é…ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ6ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: äººå·¥æ¥ç®¡è§¦å‘
```javascript
{
  actionId: "human_handover_trigger",
  actionName: "äººå·¥æ¥ç®¡è§¦å‘",
  enabled: true,
  config: {
    // è§¦å‘æ¡ä»¶
    triggerConditions: [
      {
        conditionId: "trigger_001",
        conditionName: "æŠ•è¯‰è½¬äººå·¥",
        condition: "intentResult.intent === 'complaint' && emotionResult.emotion === 'angry'",
        priority: 1
      },
      {
        conditionId: "trigger_002",
        conditionName: "é£é™©è½¬äººå·¥",
        condition: "riskLevel.level === 'critical'",
        priority: 1
      },
      {
        conditionId: "trigger_003",
        conditionName: "å¤æ‚é—®é¢˜è½¬äººå·¥",
        condition: "intentResult.confidence < 0.6",
        priority: 2
      },
      {
        conditionId: "trigger_004",
        conditionName: "å·¥ä½œäººå‘˜æ¶ˆæ¯",
        condition: "staffResult.isStaff === true",
        priority: 3
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "handoverTrigger"
  }
}
```

#### åŠ¨ä½œ2: ä»»åŠ¡åˆ†é…
```javascript
{
  actionId: "task_assignment",
  actionName: "ä»»åŠ¡åˆ†é…",
  enabled: true,
  config: {
    // åˆ†é…é…ç½®
    enableAssignment: true,          // æ˜¯å¦å¯ç”¨åˆ†é…
    // åˆ†é…ç­–ç•¥
    assignmentStrategy: "workload_based", // åˆ†é…ç­–ç•¥ï¼ˆround_robin/workload_based/skill_basedï¼‰
    // å·¥ä½œäººå‘˜é€‰æ‹©
    staffSelection: {
      filterOnline: true,            // æ˜¯å¦ä»…é€‰æ‹©åœ¨çº¿å·¥ä½œäººå‘˜
      filterAvailable: true,         // æ˜¯å¦ä»…é€‰æ‹©å¯ç”¨å·¥ä½œäººå‘˜
      filterSkills: true,            // æ˜¯å¦æ ¹æ®æŠ€èƒ½è¿‡æ»¤
      skills: ["complaint", "risk", "after_sales"] // æ‰€éœ€æŠ€èƒ½
    },
    // ä»»åŠ¡ä¿¡æ¯
    taskInfo: {
      taskType: "customer_service",  // ä»»åŠ¡ç±»å‹
      priority: "high",              // ä¼˜å…ˆçº§
      urgency: "high",               // ç´§æ€¥ç¨‹åº¦
      estimatedDuration: 1800,       // é¢„è®¡æ—¶é•¿ï¼ˆç§’ï¼‰
      description: "ç”¨æˆ·æŠ•è¯‰ï¼Œæƒ…ç»ªæ„¤æ€’ï¼Œéœ€è¦äººå·¥å¤„ç†"
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "taskAssignment"
  }
}
```

#### åŠ¨ä½œ3: é€šçŸ¥å·¥ä½œäººå‘˜
```javascript
{
  actionId: "staff_notification",
  actionName: "é€šçŸ¥å·¥ä½œäººå‘˜",
  enabled: true,
  config: {
    // é€šçŸ¥é…ç½®
    enableNotification: true,       // æ˜¯å¦å¯ç”¨é€šçŸ¥
    // é€šçŸ¥æ¸ é“
    notificationChannels: ["email", "wechat", "dingtalk"],
    // é€šçŸ¥å†…å®¹
    notificationContent: {
      title: "ã€æ–°ä»»åŠ¡ã€‘å®¢æˆ·æœåŠ¡ - ${taskInfo.priority}",
      body: "ç”¨æˆ·ï¼š${senderName}\næ„å›¾ï¼š${intentResult.intent}\næƒ…ç»ªï¼š${emotionResult.emotion}\næ¶ˆæ¯ï¼š${content}\nè¯·å°½å¿«å¤„ç†ã€‚",
      link: "https://worktool.com/tasks/${taskId}"
    },
    // æ¨¡æ¿é…ç½®
    templateId: "staff_notification_template_001",
    // è¾“å‡º
    saveToContext: true,
    contextKey: "staffNotification"
  }
}
```

#### åŠ¨ä½œ4: ç”¨æˆ·é€šçŸ¥
```javascript
{
  actionId: "user_notification",
  actionName: "ç”¨æˆ·é€šçŸ¥",
  enabled: true,
  config: {
    // é€šçŸ¥é…ç½®
    enableNotification: true,
    // é€šçŸ¥å†…å®¹
    notificationContent: {
      message: "æ‚¨çš„é—®é¢˜å·²è½¬ç»™äººå·¥å®¢æœï¼Œæˆ‘ä»¬ä¼šå°½å¿«ä¸ºæ‚¨å¤„ç†ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚",
      estimatedWaitTime: 300         // é¢„è®¡ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰
    },
    // è¾“å‡º
    saveToContext: true,
    contextKey: "userNotification"
  }
}
```

#### åŠ¨ä½œ5: ä»»åŠ¡è®°å½•
```javascript
{
  actionId: "task_logging",
  actionName: "ä»»åŠ¡è®°å½•",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "tasks",              // ç›®æ ‡è¡¨
    // ä»»åŠ¡å­—æ®µ
    taskFields: [
      "taskId",                     // ä»»åŠ¡ID
      "taskType",                   // ä»»åŠ¡ç±»å‹
      "messageId",                  // æ¶ˆæ¯ID
      "sessionId",                  // ä¼šè¯ID
      "senderId",                   // å‘é€è€…ID
      "senderName",                 // å‘é€è€…åç§°
      "assignedTo",                 // åˆ†é…ç»™
      "assignedAt",                 // åˆ†é…æ—¶é—´
      "priority",                   // ä¼˜å…ˆçº§
      "status",                     // çŠ¶æ€
      "urgency",                    // ç´§æ€¥ç¨‹åº¦
      "estimatedDuration",          // é¢„è®¡æ—¶é•¿
      "actualDuration",             // å®é™…æ—¶é•¿
      "description",                // æè¿°
      "resolution",                 // è§£å†³æ–¹æ¡ˆ
      "resolvedBy",                 // è§£å†³è€…
      "resolvedAt",                 // è§£å†³æ—¶é—´
      "createdAt",                  // åˆ›å»ºæ—¶é—´
      "updatedAt",                  // æ›´æ–°æ—¶é—´
      "metadata"                    // å…ƒæ•°æ®
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "taskLogging"
  }
}
```

#### åŠ¨ä½œ6: ååŒçŠ¶æ€è¿½è¸ª
```javascript
{
  actionId: "collaboration_tracking",
  actionName: "ååŒçŠ¶æ€è¿½è¸ª",
  enabled: true,
  config: {
    // è¿½è¸ªé…ç½®
    enableTracking: true,           // æ˜¯å¦å¯ç”¨è¿½è¸ª
    // è¿½è¸ªç»´åº¦
    trackingDimensions: [
      "taskStatus",                 // ä»»åŠ¡çŠ¶æ€
      "staffAvailability",          // å·¥ä½œäººå‘˜å¯ç”¨æ€§
      "responseTime",               // å“åº”æ—¶é—´
      "resolutionTime",             // è§£å†³æ—¶é—´
      "userSatisfaction"            // ç”¨æˆ·æ»¡æ„åº¦
    ],
    // çŠ¶æ€æ›´æ–°
    updateInterval: 10000,          // æ›´æ–°é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "collaborationTracking"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  handoverTrigger: {
    triggered: true,
    triggerCondition: "trigger_001"
  },
  taskAssignment: {
    taskId: "task_123",
    assignedTo: "staff_002",
    assignmentStrategy: "workload_based"
  },
  staffNotification: {
    sent: true,
    channels: ["email", "wechat"]
  },
  userNotification: {
    sent: true,
    message: "æ‚¨çš„é—®é¢˜å·²è½¬ç»™äººå·¥å®¢æœï¼Œæˆ‘ä»¬ä¼šå°½å¿«ä¸ºæ‚¨å¤„ç†ã€‚"
  },
  taskLogging: {
    taskId: "task_123",
    saved: true
  },
  collaborationTracking: {
    tracking: true,
    status: "pending"
  }
}
```

---

## ğŸ“ èŠ‚ç‚¹10: FLOW_ENDï¼ˆæµç¨‹ç»“æŸï¼‰

### èŠ‚ç‚¹å›¾æ ‡ä¸é¢œè‰²
- **å›¾æ ‡**: â¹ï¸
- **é¢œè‰²**: #6b7280ï¼ˆç°è‰²ï¼‰

### èŠ‚ç‚¹æè¿°
æµç¨‹ç»“æŸç‚¹ï¼Œæ¸…ç†ä¸Šä¸‹æ–‡ã€ä¿å­˜æ‰§è¡Œæ—¥å¿—ã€è¾“å‡ºæœ€ç»ˆç»“æœã€‚

### ç³»ç»Ÿè”åŠ¨
- âœ… æµç¨‹æ§åˆ¶ï¼ˆæµç¨‹ç®¡ç†ï¼‰
- âœ… ç›‘æ§ç³»ç»Ÿï¼ˆæ‰§è¡Œæ—¥å¿—ï¼‰

### é…ç½®é€‰é¡¹ï¼ˆ5ä¸ªåŠ¨ä½œï¼‰

#### åŠ¨ä½œ1: æµç¨‹ç»“æœè¾“å‡º
```javascript
{
  actionId: "flow_result_output",
  actionName: "æµç¨‹ç»“æœè¾“å‡º",
  enabled: true,
  config: {
    // è¾“å‡ºé…ç½®
    enableOutput: true,             // æ˜¯å¦å¯ç”¨è¾“å‡º
    // è¾“å‡ºå˜é‡
    outputVariables: {
      messageId: "message.messageId",
      sessionId: "message.sessionId",
      senderName: "message.senderName",
      content: "message.content",
      intent: "intentResult.intent",
      emotion: "emotionResult.emotion",
      aiResponse: "aiResponse.content",
      status: "status",
      executedAt: "currentTime()"
    },
    // è¾“å‡ºæ ¼å¼
    outputFormat: "json",            // è¾“å‡ºæ ¼å¼ï¼ˆjson/xml/csvï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "flowResult"
  }
}
```

#### åŠ¨ä½œ2: æ‰§è¡Œæ—¥å¿—è®°å½•
```javascript
{
  actionId: "execution_logging",
  actionName: "æ‰§è¡Œæ—¥å¿—è®°å½•",
  enabled: true,
  config: {
    // ä¿å­˜é…ç½®
    saveToDatabase: true,            // æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“
    tableName: "flow_execution_logs", // ç›®æ ‡è¡¨
    // æ—¥å¿—å­—æ®µ
    logFields: [
      "executionId",                // æ‰§è¡ŒID
      "flowId",                     // æµç¨‹ID
      "flowName",                   // æµç¨‹åç§°
      "flowInstanceId",             // æµç¨‹å®ä¾‹ID
      "sessionId",                  // ä¼šè¯ID
      "messageId",                  // æ¶ˆæ¯ID
      "nodes",                      // èŠ‚ç‚¹åˆ—è¡¨
      "nodeExecutions",             // èŠ‚ç‚¹æ‰§è¡Œè®°å½•
      "totalExecutionTime",         // æ€»æ‰§è¡Œæ—¶é—´
      "status",                     // çŠ¶æ€
      "error",                      // é”™è¯¯ä¿¡æ¯
      "result",                     // ç»“æœ
      "startedAt",                  // å¼€å§‹æ—¶é—´
      "completedAt",                // å®Œæˆæ—¶é—´
      "timestamp"                   // æ—¶é—´æˆ³
    ],
    // æ—¥å¿—çº§åˆ«
    logLevel: "info",               // æ—¥å¿—çº§åˆ«ï¼ˆdebug/info/warn/errorï¼‰
    // è¾“å‡º
    saveToContext: true,
    contextKey: "executionLogging"
  }
}
```

#### åŠ¨ä½œ3: ä¸Šä¸‹æ–‡æ¸…ç†
```javascript
{
  actionId: "context_cleanup",
  actionName: "ä¸Šä¸‹æ–‡æ¸…ç†",
  enabled: true,
  config: {
    // æ¸…ç†é…ç½®
    enableCleanup: true,            // æ˜¯å¦å¯ç”¨æ¸…ç†
    // æ¸…ç†ç­–ç•¥
    cleanupStrategies: [
      {
        strategyId: "cleanup_001",
        strategyName: "æ¸…ç†ä¸´æ—¶å˜é‡",
        targets: ["tempVariables", "cache"],
        preserve: []
      },
      {
        strategyId: "cleanup_002",
        strategyName: "ä¿ç•™å…³é”®æ•°æ®",
        targets: [],
        preserve: ["sessionId", "messageId", "aiResponse"]
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "contextCleanup"
  }
}
```

#### åŠ¨ä½œ4: èµ„æºé‡Šæ”¾
```javascript
{
  actionId: "resource_release",
  actionName: "èµ„æºé‡Šæ”¾",
  enabled: true,
  config: {
    // é‡Šæ”¾é…ç½®
    enableRelease: true,            // æ˜¯å¦å¯ç”¨é‡Šæ”¾
    // é‡Šæ”¾èµ„æº
    resources: [
      {
        type: "database_connection", // æ•°æ®åº“è¿æ¥
        release: true
      },
      {
        type: "cache",              // ç¼“å­˜
        release: true
      },
      {
        type: "file_handles",       // æ–‡ä»¶å¥æŸ„
        release: true
      },
      {
        type: "memory",             // å†…å­˜
        release: true
      }
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "resourceRelease"
  }
}
```

#### åŠ¨ä½œ5: æµç¨‹ç»Ÿè®¡
```javascript
{
  actionId: "flow_statistics",
  actionName: "æµç¨‹ç»Ÿè®¡",
  enabled: true,
  config: {
    // ç»Ÿè®¡é…ç½®
    enableStatistics: true,         // æ˜¯å¦å¯ç”¨ç»Ÿè®¡
    // ç»Ÿè®¡ç»´åº¦
    statisticsDimensions: [
      "date",                        // æ—¥æœŸ
      "hour",                        // å°æ—¶
      "flowId",                      // æµç¨‹ID
      "flowName",                    // æµç¨‹åç§°
      "status",                      // çŠ¶æ€
      "result"                       // ç»“æœ
    ],
    // ç»Ÿè®¡æŒ‡æ ‡
    statisticsMetrics: [
      "totalExecutions",             // æ€»æ‰§è¡Œæ¬¡æ•°
      "successfulExecutions",        // æˆåŠŸæ‰§è¡Œæ¬¡æ•°
      "failedExecutions",            // å¤±è´¥æ‰§è¡Œæ¬¡æ•°
      "averageExecutionTime",        // å¹³å‡æ‰§è¡Œæ—¶é—´
      "nodeExecutionCount",          // èŠ‚ç‚¹æ‰§è¡Œæ¬¡æ•°
      "averageNodeExecutionTime",    // å¹³å‡èŠ‚ç‚¹æ‰§è¡Œæ—¶é—´
      "errorRate"                    // é”™è¯¯ç‡
    ],
    // è¾“å‡º
    saveToContext: true,
    contextKey: "flowStatistics"
  }
}
```

### è¾“å‡ºæ•°æ®
```javascript
{
  success: true,
  flowResult: {
    messageId: "msg_123456",
    sessionId: "sess_789012",
    senderName: "å¼ ä¸‰",
    content: "æˆ‘è¦é€€è´§",
    intent: "complaint",
    emotion: "angry",
    aiResponse: "æ‚¨å¥½ï¼Œæˆ‘ç†è§£æ‚¨çš„è¯‰æ±‚...",
    status: "completed",
    executedAt: "2025-01-04T10:05:00Z"
  },
  executionLogging: {
    executionId: "exec_123",
    saved: true,
    totalExecutionTime: 5200
  },
  contextCleanup: {
    cleaned: true,
    preservedVariables: ["sessionId", "messageId", "aiResponse"]
  },
  resourceRelease: {
    released: true,
    resourcesReleased: 4
  },
  flowStatistics: {
    totalExecutions: 1000,
    successfulExecutions: 980,
    failedExecutions: 20,
    averageExecutionTime: 5000,
    errorRate: 0.02
  }
}
```

---

## ğŸ“Š èŠ‚ç‚¹ç»Ÿè®¡æ±‡æ€»

### èŠ‚ç‚¹æ•°é‡ç»Ÿè®¡
| åˆ†ç±» | èŠ‚ç‚¹æ•°é‡ | åŠ¨ä½œæ€»æ•° |
|------|---------|---------|
| å…¥å£èŠ‚ç‚¹ | 1 | 6 |
| AIåˆ†æèŠ‚ç‚¹ | 1 | 6 |
| å†³ç­–èŠ‚ç‚¹ | 1 | 6 |
| ä¸šåŠ¡å¤„ç†èŠ‚ç‚¹ | 3 | 21ï¼ˆAI 8 + é£é™© 7 + ååŒ 6ï¼‰ |
| æ¶ˆæ¯æ“ä½œèŠ‚ç‚¹ | 1 | 8 |
| ç›‘æ§æ£€æµ‹èŠ‚ç‚¹ | 1 | 6 |
| å‘Šè­¦å‡çº§èŠ‚ç‚¹ | 1 | 7 |
| äººå·¥æ¥ç®¡èŠ‚ç‚¹ | 1 | 6 |
| ç»“æŸèŠ‚ç‚¹ | 1 | 5 |
| **æ€»è®¡** | **10** | **71** |

### ç³»ç»Ÿè”åŠ¨è¦†ç›–
| ç³»ç»Ÿ | è¦†ç›–èŠ‚ç‚¹æ•° | è¦†ç›–åŠ¨ä½œæ•° |
|------|-----------|-----------|
| æ¶ˆæ¯ä¸­å¿ƒ | 3 | 14 |
| AIæ¨¡å— | 2 | 14 |
| æœºå™¨äººç®¡ç† | 2 | 10 |
| å‘Šè­¦ç³»ç»Ÿ | 2 | 7 |
| é£é™©ç®¡ç† | 1 | 7 |
| ç›‘æ§ç³»ç»Ÿ | 2 | 11 |
| ååŒç³»ç»Ÿ | 2 | 12 |
| æµç¨‹æ§åˆ¶ | 3 | 17 |

---

## ğŸ¯ é»˜è®¤æµç¨‹ç¤ºä¾‹

### å®¢æœå›å¤æµç¨‹
```
MESSAGE_ENTRY â†’ SMART_ANALYZE â†’ FLOW_DECISION â†’ AI_AGENT â†’ MESSAGE_EXIT â†’ FLOW_END
```

### é£é™©å¤„ç†æµç¨‹
```
MESSAGE_ENTRY â†’ SMART_ANALYZE â†’ FLOW_DECISION â†’ RISK_HANDLER â†’ MESSAGE_EXIT â†’ FLOW_END
```

### äººå·¥æ¥ç®¡æµç¨‹
```
MESSAGE_ENTRY â†’ SMART_ANALYZE â†’ FLOW_DECISION â†’ HUMAN_HANDOVER â†’ STAFF_COOPERATE â†’ MESSAGE_EXIT â†’ FLOW_END
```

### å‘Šè­¦å‡çº§æµç¨‹
```
MESSAGE_ENTRY â†’ SMART_ANALYZE â†’ RISK_HANDLER â†’ ALERT_ESCALATION â†’ FLOW_END
```

---

## ğŸ“ å®æ–½å»ºè®®

### ä¼˜å…ˆçº§ï¼ˆP0-P3ï¼‰
- **P0ï¼ˆå¿…é¡»ï¼‰**: MESSAGE_ENTRYã€SMART_ANALYZEã€FLOW_DECISIONã€AI_AGENTã€MESSAGE_EXITã€FLOW_END
- **P1ï¼ˆé‡è¦ï¼‰**: RISK_HANDLERã€HUMAN_HANDOVER
- **P2ï¼ˆä¼˜åŒ–ï¼‰**: SMART_MONITORã€ALERT_ESCALATION

### å¼€å‘é¡ºåº
1. åŸºç¡€æµç¨‹ï¼ˆMESSAGE_ENTRY â†’ SMART_ANALYZE â†’ FLOW_DECISION â†’ AI_AGENT â†’ MESSAGE_EXIT â†’ FLOW_ENDï¼‰
2. é£é™©å¤„ç†ï¼ˆRISK_HANDLERï¼‰
3. äººå·¥æ¥ç®¡ï¼ˆHUMAN_HANDOVER + STAFF_COOPERATEï¼‰
4. ç›‘æ§å‘Šè­¦ï¼ˆSMART_MONITOR + ALERT_ESCALATIONï¼‰

### æµ‹è¯•ç­–ç•¥
- å•å…ƒæµ‹è¯•ï¼šæ¯ä¸ªåŠ¨ä½œç‹¬ç«‹æµ‹è¯•
- é›†æˆæµ‹è¯•ï¼šèŠ‚ç‚¹è”åŠ¨æµ‹è¯•
- æ€§èƒ½æµ‹è¯•ï¼šå¹¶å‘ã€å“åº”æ—¶é—´æµ‹è¯•
- ç”¨æˆ·æµ‹è¯•ï¼šçœŸå®åœºæ™¯æµ‹è¯•

---

## ğŸ“ æ€»ç»“

æœ¬è®¾è®¡åŸºäºå†…éƒ¨æ–‡æ¡£ï¼Œå°†æµç¨‹å¼•æ“ä¼˜åŒ–ä¸º10ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ”¯æŒå¤šä¸ªåŠ¨ä½œï¼Œæ€»è®¡71ä¸ªåŠ¨ä½œï¼Œè¦†ç›–æ‰€æœ‰ç³»ç»Ÿè”åŠ¨ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**:
- âœ… èŠ‚ç‚¹ç²¾ç®€ï¼šä»32ç§å‡å°‘åˆ°10ç§ï¼Œå‡å°‘69%
- âœ… åŠŸèƒ½å®Œæ•´ï¼šè¦†ç›–æ‰€æœ‰ä¸šåŠ¡åœºæ™¯
- âœ… é…ç½®çµæ´»ï¼šæ¯ä¸ªåŠ¨ä½œç‹¬ç«‹é…ç½®
- âœ… æ˜“äºç»´æŠ¤ï¼šå‰åç«¯é…ç½®ä¸€è‡´
- âœ… å¯æ‰©å±•ï¼šæ”¯æŒè‡ªå®šä¹‰åŠ¨ä½œ
