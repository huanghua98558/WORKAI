# WorkTool AI 中枢系统 - 多机器人管理集成文档

## 🎉 集成完成

新开发的多机器人管理功能已成功集成到主系统中！

## 📋 新增功能 Tab

在主页面（http://localhost:5000）的导航栏中，新增了以下 4 个 Tab：

### 1. 分组管理 (robot-groups)
- **位置**: "机器人管理" tab 之后
- **图标**: 🏢 (Building2)
- **功能**:
  - 创建和管理机器人分组
  - 配置分组图标、颜色、优先级
  - 支持 5 种路由策略（轮询、最少负载、优先级、随机、哈希）
  - 负载均衡配置

### 2. 角色管理 (robot-roles)
- **位置**: "分组管理" tab 之后
- **图标**: 🛡️ (ShieldCheck)
- **功能**:
  - 创建和管理机器人角色
  - 细粒度权限控制（14 种权限）
  - 12 种支持的操作类型
  - 速率限制配置

### 3. 指令发送 (command-sender)
- **位置**: "角色管理" tab 之后
- **图标**: ✨ (Sparkles)
- **功能**:
  - 实时发送指令到在线机器人
  - 支持 8 种指令类型
    - 发送消息
    - 转发消息
    - 创建群聊
    - 邀请入群
    - 上传文件
    - 获取联系人
    - 获取群聊
    - 更新资料
  - 实时查看执行状态
  - 失败自动重试

### 4. 监控大屏 (monitoring-dashboard)
- **位置**: "指令发送" tab 之后
- **图标**: 📊 (BarChart3)
- **功能**:
  - 实时监控几十个机器人状态
  - 健康度、成功率、负载可视化
  - 自动刷新（10 秒）
  - 错误统计和分析
  - 可选时间范围（1h、6h、24h、7d）

## 🔄 导航栏更新

原导航栏有 11 个 Tab，现在已更新为 15 个 Tab：

```
├─ 仪表盘 (dashboard)
├─ 会话管理 (sessions)
├─ 机器人管理 (robots)
├─ 分组管理 (robot-groups)          [新增]
├─ 角色管理 (robot-roles)            [新增]
├─ 指令发送 (command-sender)         [新增]
├─ 监控大屏 (monitoring-dashboard)   [新增]
├─ 监控告警 (monitor)
├─ 实时IO (realtime)
├─ 报告中心 (reports)
├─ 回调中心 (callbacks)
├─ 用户管理 (users)
├─ 问答库 (qa)
├─ 系统设置 (settings)
└─ 系统日志 (system-logs)
```

## 🚀 使用指南

### 访问新功能

1. **打开主页面**: http://localhost:5000
2. **点击导航栏**中的新 Tab

#### 分组管理

```
1. 点击 "分组管理" Tab
2. 点击 "创建分组" 按钮
3. 填写分组信息：
   - 分组名称（必填）
   - 描述（可选）
   - 选择图标（从 10 个预设图标中选择）
   - 选择颜色（从 10 个预设颜色中选择）
   - 设置优先级（0-100）
   - 选择路由策略
   - 配置负载均衡参数（JSON）
4. 点击 "创建"
```

#### 角色管理

```
1. 点击 "角色管理" Tab
2. 点击 "创建角色" 按钮
3. 填写角色信息：
   - 角色名称（必填）
   - 设置优先级（0-100）
   - 描述（可选）
   - 选择权限（14 种权限，可多选）
   - 选择允许的操作（12 种操作，可多选）
   - 配置速率限制（JSON）
4. 点击 "创建"
```

#### 指令发送

```
1. 点击 "指令发送" Tab
2. 选择机器人（仅显示在线机器人）
3. 选择指令类型（8 种类型）
4. 设置优先级（最高、高、中、低、最低）
5. 填写指令内容（JSON 格式）
6. 点击 "发送指令"
7. 实时查看执行状态
```

#### 监控大屏

```
1. 点击 "监控大屏" Tab
2. 选择时间范围（1h、6h、24h、7d）
3. 查看统计数据：
   - 机器人总数、在线数
   - 会话统计（活跃、总计）
   - 指令统计（累计执行）
   - 整体健康度、成功率、利用率
4. 查看每个机器人的详细状态：
   - 健康度、成功率、负载
   - 会话数、指令数
   - 响应时间
5. 查看错误统计（如有）
```

## 🔗 在机器人管理中的提示

在 "机器人管理" 页面中，统计卡片下方添加了新功能提示：

```
┌─────────────────────────────────────────────────┐
│ ℹ️ 新功能推荐                                   │
│ 系统现已支持分组管理和角色管理，可以帮助您更好地  │
│ 组织和管理多个机器人。                          │
│                                                 │
│ [分组管理] [角色管理] [指令发送] [监控大屏]     │
└─────────────────────────────────────────────────┘
```

点击按钮即可直接跳转到对应的功能页面。

## 📡 后端 API 集成

所有新功能的 API 端点都已经创建并集成：

- `/api/admin/robot-groups` - 分组管理
- `/api/admin/robot-roles` - 角色管理
- `/api/admin/robot-commands` - 指令队列
- `/api/admin/robot-loadbalancing` - 负载均衡
- `/api/admin/robot-monitoring` - 性能监控
- `/api/admin/robot-callback-logs` - 回调日志

## 🎨 组件集成

新增的组件已导入并使用：

```typescript
import RobotGroupManager from '@/components/robot/robot-group-manager';
import RobotRoleManager from '@/components/robot/robot-role-manager';
import CommandSender from '@/components/robot/command-sender';
import MonitoringDashboard from '@/components/robot/monitoring-dashboard';
```

## 📝 注意事项

1. **服务运行**: 确保 `coze dev` 服务正在运行（端口 5000）
2. **数据库**: 确保数据库连接正常（PostgreSQL）
3. **API 端点**: 所有 API 端点已创建，可直接调用
4. **权限控制**: API 认证和授权中间件已集成（需要 Bearer Token）

## 🔜 后续优化建议

1. **快捷操作**: 在机器人列表中添加快捷跳转按钮
2. **批量操作**: 支持批量分配分组和角色
3. **模板配置**: 提供分组和角色的预设模板
4. **导出功能**: 支持导出监控数据和指令记录
5. **通知提醒**: 添加任务完成和告警通知

## 📞 技术支持

如遇问题，请检查：
1. 服务是否正常运行
2. 数据库连接是否正常
3. API 端点是否可访问
4. 浏览器控制台是否有错误信息

---

**集成完成时间**: 2024
**集成内容**: 4 个新功能 Tab + 6 个 API 端点 + 4 个前端组件
**集成方式**: 直接集成到主系统页面
