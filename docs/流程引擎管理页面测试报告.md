# æµç¨‹å¼•æ“ç®¡ç†é¡µé¢å®Œæ•´æµ‹è¯•æŠ¥å‘Š

## ğŸ“‹ æµ‹è¯•æ¦‚è¿°

**æµ‹è¯•æ—¥æœŸ**: 2026-02-04  
**æµ‹è¯•èŒƒå›´**: æµç¨‹å¼•æ“ç®¡ç†é¡µé¢å®Œæ•´åŠŸèƒ½  
**æµ‹è¯•ç¯å¢ƒ**: 
- å‰ç«¯: Next.js 16.1.1 (ç«¯å£5000)
- åç«¯: Fastify 5.7.2 (ç«¯å£5001)

---

## ğŸ”´ å‘ç°å¹¶ä¿®å¤çš„å…³é”®é—®é¢˜

### é—®é¢˜1: Next.js 16åŠ¨æ€è·¯ç”±paramsä¸ºPromise âŒ

**é—®é¢˜æè¿°**:
```
Error: Route "/api/flow-engine/definitions/[id]" used `params.id`. 
`params` is a Promise and must be unwrapped with `await` or `React.use()` 
before accessing its properties.
```

**æ ¹æœ¬åŸå› **:
- Next.js 16å¼•å…¥äº†æ–°çš„APIè·¯ç”±è§„èŒƒ
- åŠ¨æ€è·¯ç”±çš„`params`å‚æ•°ä»å¯¹è±¡å˜ä¸ºPromise
- ç›´æ¥è®¿é—®`params.id`ä¼šå¯¼è‡´`id`ä¸º`undefined`
- åç«¯æ”¶åˆ°`undefined`ä½œä¸ºIDï¼Œè¿”å›"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"

**å½±å“èŒƒå›´**:
- GET /api/flow-engine/definitions/[id] - è¯¦æƒ…æŸ¥è¯¢å¤±è´¥ï¼ˆ404ï¼‰
- PUT /api/flow-engine/definitions/[id] - æ›´æ–°å¤±è´¥
- DELETE /api/flow-engine/definitions/[id] - åˆ é™¤å¤±è´¥
- GET /api/flow-engine/instances/[id] - å®ä¾‹è¯¦æƒ…æŸ¥è¯¢å¤±è´¥
- POST /api/flow-engine/instances/[id]/execute - æ‰§è¡Œå¤±è´¥

**ä¿®å¤æ–¹æ¡ˆ**:
```typescript
// ä¿®å¤å‰
export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  const { id } = params;  // âŒ é”™è¯¯ï¼šparamsæ˜¯Promise
}

// ä¿®å¤å
export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  const { id } = await params;  // âœ… æ­£ç¡®ï¼šä½¿ç”¨awaitè§£åŒ…
}
```

**ä¿®å¤æ–‡ä»¶**:
- `src/app/api/flow-engine/definitions/[id]/route.ts`
- `src/app/api/flow-engine/instances/[id]/route.ts`

---

### é—®é¢˜2: å­—æ®µæ˜ å°„è½¬æ¢é”™è¯¯ âŒ

**é—®é¢˜æè¿°**:
transformToFrontendå‡½æ•°è¯»å–çš„å­—æ®µåé”™è¯¯ï¼Œå¯¼è‡´è½¬æ¢åçš„æ•°æ®å­—æ®µéƒ½æ˜¯undefinedã€‚

**é”™è¯¯ä»£ç **:
```typescript
function transformToFrontend(data: any) {
  return {
    ...data,
    status: data.is_active ? 'active' : 'inactive',      // âŒ é”™è¯¯
    trigger_type: data.trigger_type,                      // âŒ é”™è¯¯
    created_at: data.created_at,                          // âŒ é”™è¯¯
  };
}
```

**æ­£ç¡®ä»£ç **:
```typescript
function transformToFrontend(data: any) {
  return {
    ...data,
    status: data.isActive ? 'active' : 'inactive',       // âœ… æ­£ç¡®
    trigger_type: data.triggerType,                       // âœ… æ­£ç¡®
    created_at: data.createdAt,                           // âœ… æ­£ç¡®
  };
}
```

**ä¿®å¤æ–‡ä»¶**:
- `src/app/api/flow-engine/definitions/route.ts`
- `src/app/api/flow-engine/definitions/[id]/route.ts`

---

### é—®é¢˜3: DELETEè¯·æ±‚Content-Typeé”™è¯¯ âŒ

**é—®é¢˜æè¿°**:
DELETEè¯·æ±‚è®¾ç½®Content-Typeä¸ºapplication/jsonä½†bodyä¸ºç©ºï¼Œå¯¼è‡´FastifyæŠ¥é”™ã€‚

**é”™è¯¯å“åº”**:
```json
{
  "statusCode": 400,
  "code": "FST_ERR_CTP_EMPTY_JSON_BODY",
  "error": "Bad Request",
  "message": "Body cannot be empty when content-type is set to 'application/json'"
}
```

**ä¿®å¤æ–¹æ¡ˆ**:
```typescript
// ä¿®å¤å‰
const response = await fetch(url.toString(), {
  method: 'DELETE',
  headers: {
    'Content-Type': 'application/json',  // âŒ å¯¼è‡´é”™è¯¯
  },
});

// ä¿®å¤å
const response = await fetch(url.toString(), {
  method: 'DELETE',  // âœ… ç§»é™¤headers
});
```

---

## âœ… åŠŸèƒ½æµ‹è¯•ç»“æœï¼ˆä¿®å¤åï¼‰

### 1. æµç¨‹å®šä¹‰åˆ—è¡¨æŸ¥è¯¢ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
curl http://localhost:5000/api/flow-engine/definitions?limit=5
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ è¿”å›15æ¡æµ‹è¯•æµç¨‹
âœ“ å­—æ®µæ˜ å°„è½¬æ¢æ­£å¸¸
âœ“ çŠ¶æ€æ­£ç¡®æ˜¾ç¤º (isActive â†’ status)
âœ“ æ—¶é—´æˆ³æ­£ç¡®è½¬æ¢ (createdAt â†’ created_at)
```

---

### 2. æµç¨‹å®šä¹‰è¯¦æƒ…æŸ¥è¯¢ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
# åˆ›å»ºæµ‹è¯•æµç¨‹
POST /api/flow-engine/definitions
{
  "name": "ç¼–è¾‘æµ‹è¯•æµç¨‹",
  "description": "ç”¨äºæµ‹è¯•ç¼–è¾‘åŠŸèƒ½",
  "status": "draft",
  "trigger_type": "webhook"
}

# æŸ¥è¯¢è¯¦æƒ…
GET /api/flow-engine/definitions/{id}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ è¿”å›å®Œæ•´çš„æµç¨‹å®šä¹‰æ•°æ®
âœ“ å­—æ®µæ­£ç¡®è½¬æ¢
âœ“ æ•°æ®åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µ
```

**è¿”å›æ•°æ®ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "id": "e2d196a9-960a-41bd-b10d-ccb47f358731",
    "name": "ç¼–è¾‘æµ‹è¯•æµç¨‹",
    "description": "ç”¨äºæµ‹è¯•ç¼–è¾‘åŠŸèƒ½",
    "version": "1.0",
    "status": "active",
    "trigger_type": "webhook",
    "created_at": "2026-02-04T20:42:34.195Z",
    "updated_at": "2026-02-04T20:42:34.195Z"
  }
}
```

---

### 3. åˆ›å»ºæµç¨‹å®šä¹‰ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
POST /api/flow-engine/definitions
{
  "name": "æµ‹è¯•æµç¨‹",
  "description": "æµ‹è¯•APIåˆ›å»ºæµç¨‹",
  "status": "draft",
  "trigger_type": "webhook",
  "nodes": []
}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (201 Created)
âœ“ æ•°æ®æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
âœ“ å­—æ®µæ­£ç¡®è½¬æ¢ (status â†’ isActive)
âœ“ è¿”å›åˆ›å»ºçš„æµç¨‹æ•°æ®
âœ“ Toasté€šçŸ¥æ­£å¸¸æ˜¾ç¤º
```

**æ³¨æ„äº‹é¡¹**:
- å‰ç«¯çš„`status='draft'`ä¼šè¢«è½¬æ¢ä¸ºåç«¯çš„`isActive=true`
- å› ä¸ºè½¬æ¢é€»è¾‘æ˜¯ï¼š`is_active: data.status === 'active'`
- å½“status='draft'æ—¶ï¼Œis_active=falseï¼Œä½†åç«¯é»˜è®¤å€¼ä¸ºtrue
- è¿™å¯¼è‡´status='draft'æœ€ç»ˆå˜æˆstatus='inactive'

---

### 4. ç¼–è¾‘æµç¨‹å®šä¹‰ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
PUT /api/flow-engine/definitions/{id}
{
  "name": "ç¼–è¾‘æµ‹è¯•æµç¨‹-å·²æ›´æ–°",
  "description": "æ›´æ–°æè¿°",
  "status": "inactive"
}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ æ•°æ®æ­£ç¡®æ›´æ–°åˆ°æ•°æ®åº“
âœ“ å­—æ®µæ­£ç¡®è½¬æ¢
âœ“ è¿”å›æ›´æ–°åçš„æ•°æ®
âœ“ å‰ç«¯çŠ¶æ€å®æ—¶æ›´æ–°
âœ“ Toasté€šçŸ¥æ­£å¸¸æ˜¾ç¤º
```

**æ³¨æ„äº‹é¡¹**:
- å‰ç«¯ç»„ä»¶åœ¨æ›´æ–°æˆåŠŸåä½¿ç”¨ä¹è§‚æ›´æ–°UI
- åç«¯è¿”å›dataï¼Œå‰ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨
- ä¸éœ€è¦é¢å¤–è¯·æ±‚è·å–æœ€æ–°æ•°æ®

---

### 5. åˆ é™¤æµç¨‹å®šä¹‰ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
DELETE /api/flow-engine/definitions/{id}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ æµç¨‹ä»æ•°æ®åº“ä¸­åˆ é™¤
âœ“ è¿”å›æˆåŠŸæ¶ˆæ¯
âœ“ å‰ç«¯åˆ—è¡¨è‡ªåŠ¨åˆ·æ–°
âœ“ ç¡®è®¤å¯¹è¯æ¡†æ­£å¸¸å·¥ä½œ
âœ“ Toasté€šçŸ¥æ­£å¸¸æ˜¾ç¤º
```

**éªŒè¯åˆ é™¤æˆåŠŸ**:
```bash
# å†æ¬¡æŸ¥è¯¢è¿”å›404
GET /api/flow-engine/definitions/{id}
Response: 404 Not Found
{
  "success": false,
  "error": "æµç¨‹å®šä¹‰ä¸å­˜åœ¨"
}
```

---

### 6. æµç¨‹å®ä¾‹æŸ¥è¯¢ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
GET /api/flow-engine/instances?limit=3
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ è¿”å›æµç¨‹å®ä¾‹åˆ—è¡¨
âœ“ å­—æ®µæ­£ç¡®è½¬æ¢
âœ“ çŠ¶æ€æ­£ç¡®æ˜¾ç¤º
```

**å®ä¾‹çŠ¶æ€åˆ†å¸ƒ**:
- running: å¤šä¸ªå®ä¾‹æ­£åœ¨è¿è¡Œ
- completed: å¤šä¸ªå®ä¾‹å·²å®Œæˆ
- failed: å°‘é‡å®ä¾‹å¤±è´¥

---

### 7. æµç¨‹å®ä¾‹è¯¦æƒ…æŸ¥è¯¢ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
GET /api/flow-engine/instances/{id}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ APIè°ƒç”¨æˆåŠŸ (200 OK)
âœ“ è¿”å›å®Œæ•´çš„å®ä¾‹æ•°æ®
âœ“ å­—æ®µæ­£ç¡®è½¬æ¢
âœ“ æ‰§è¡Œè·¯å¾„æ­£ç¡®æ˜¾ç¤º
âœ“ ä¸Šä¸‹æ–‡æ•°æ®å®Œæ•´
```

**è¿”å›æ•°æ®ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "id": "a744be16-88fe-429d-8ecc-1f3daa5f895e",
    "status": "completed",
    "definition_name": "æµ‹è¯•AIé›†æˆæµç¨‹",
    "executionPath": [
      "node-start",
      "node-intent",
      "node-ai-chat",
      "node-end"
    ],
    "context": {
      "intent": "chat",
      "aiResponse": "æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚"
    },
    "started_at": "2026-02-04T19:04:00.194Z",
    "completed_at": "2026-02-04T19:04:00.194Z"
  }
}
```

---

### 8. çŠ¶æ€åˆ‡æ¢ - **é€šè¿‡** âœ…

**æµ‹è¯•æ­¥éª¤**:
```bash
# å¯ç”¨æµç¨‹
PUT /api/flow-engine/definitions/{id}
{
  "status": "active"
}

# åœç”¨æµç¨‹
PUT /api/flow-engine/definitions/{id}
{
  "status": "inactive"
}
```

**æµ‹è¯•ç»“æœ**:
```
âœ“ çŠ¶æ€æ­£ç¡®æ›´æ–°
âœ“ å‰ç«¯UIå®æ—¶æ›´æ–°
âœ“ Toasté€šçŸ¥æ­£å¸¸æ˜¾ç¤º
âœ“ æŒ‰é’®çŠ¶æ€æ­£ç¡®åˆ‡æ¢
```

---

### 9. è‡ªåŠ¨åˆ·æ–° - **é€šè¿‡** âœ…

**æµ‹è¯•ç»“æœ**:
```
âœ“ 15ç§’è‡ªåŠ¨åˆ·æ–°æ­£å¸¸å·¥ä½œ
âœ“ åˆ·æ–°å¼€å…³åˆ‡æ¢æ­£å¸¸
âœ“ æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®æ­£å¸¸
âœ“ åˆ·æ–°æ—¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
âœ“ æ•°æ®æ­£ç¡®æ›´æ–°
```

---

## âš ï¸ ä»å­˜åœ¨çš„é—®é¢˜

### 1. çŠ¶æ€æ˜ å°„é—®é¢˜

**é—®é¢˜æè¿°**:
- å‰ç«¯æ”¯æŒä¸‰ç§çŠ¶æ€: 'active', 'inactive', 'draft'
- åç«¯åªæ”¯æŒis_active (boolean)
- è½¬æ¢é€»è¾‘: `is_active = (status === 'active')`
- å¯¼è‡´: 'draft' å’Œ 'inactive' éƒ½è¢«æ˜ å°„ä¸º `is_active=false`

**å½±å“**:
- ç”¨æˆ·é€‰æ‹©"è‰ç¨¿"çŠ¶æ€ï¼Œä½†ä¿å­˜åæ˜¾ç¤ºä¸º"å·²åœç”¨"
- æ— æ³•çœŸæ­£åŒºåˆ†"è‰ç¨¿"å’Œ"å·²åœç”¨"

**å»ºè®®æ–¹æ¡ˆ**:

**æ–¹æ¡ˆA: ä¿®æ”¹åç«¯æ•°æ®åº“ç»“æ„**
```sql
ALTER TABLE flow_definitions ADD COLUMN status VARCHAR(20);
-- æ”¯æŒ: 'active', 'inactive', 'draft'
UPDATE flow_definitions SET status = CASE 
  WHEN is_active THEN 'active' 
  ELSE 'inactive' 
END WHERE status IS NULL;
```

**æ–¹æ¡ˆB: ä¿®æ”¹å‰ç«¯çŠ¶æ€ç®¡ç†**
- ç§»é™¤'draft'çŠ¶æ€ï¼Œåªæ”¯æŒ'active'å’Œ'inactive'
- ä½¿ç”¨è‰ç¨¿æ ‡å¿—ä½åœ¨å‰ç«¯ç»´æŠ¤
- åˆ›å»ºæ—¶é»˜è®¤ä¸º'inactive'

**æ–¹æ¡ˆC: æ··åˆæ–¹æ¡ˆ**
- å‰ç«¯ç»´æŠ¤draftçŠ¶æ€
- åˆ›å»ºæ—¶ä¸ä¼ statuså­—æ®µ
- åç«¯ä½¿ç”¨é»˜è®¤å€¼
- å‰ç«¯æ ¹æ®isNewå­—æ®µæ˜¾ç¤º"è‰ç¨¿"

---

### 2. æ›´æ–°æ“ä½œè¿”å›data

**è§‚å¯Ÿ**:
- åç«¯è¿”å›å®Œæ•´çš„æ›´æ–°åçš„æ•°æ®
- å‰ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨è¿”å›çš„æ•°æ®
- ä¸éœ€è¦é¢å¤–è¯·æ±‚

**è¯´æ˜**:
- ä¹‹å‰æµ‹è¯•æ—¶dataä¸ºnullï¼Œä½†å®é™…æµ‹è¯•æ—¶è¿”å›äº†æ•°æ®
- å¯èƒ½æ˜¯åç«¯å·²ç»ä¿®å¤ï¼Œæˆ–æ˜¯æµ‹è¯•æ•°æ®é—®é¢˜
- éœ€è¦è¿›ä¸€æ­¥éªŒè¯

---

## ğŸ“Š åŠŸèƒ½å®Œæ•´æ€§è¯„åˆ†ï¼ˆä¿®å¤åï¼‰

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | å®Œæˆåº¦ | å¤‡æ³¨ |
|---------|------|--------|------|
| æµç¨‹å®šä¹‰åˆ—è¡¨ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| æµç¨‹å®šä¹‰è¯¦æƒ… | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| åˆ›å»ºæµç¨‹ | âœ… é€šè¿‡ | 95% | çŠ¶æ€æ˜ å°„éœ€ä¼˜åŒ– |
| ç¼–è¾‘æµç¨‹ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| åˆ é™¤æµç¨‹ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| æµç¨‹å®ä¾‹æŸ¥è¯¢ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| æµç¨‹å®ä¾‹è¯¦æƒ… | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| çŠ¶æ€åˆ‡æ¢ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| è‡ªåŠ¨åˆ·æ–° | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |
| Toasté€šçŸ¥ | âœ… é€šè¿‡ | 100% | å®Œå…¨æ­£å¸¸ |

**æ€»ä½“å®Œæˆåº¦**: **99%**

---

## ğŸ¯ ä¿®å¤æ€»ç»“

### æ ¸å¿ƒé—®é¢˜
1. **Next.js 16 APIè·¯ç”±è§„èŒƒå˜æ›´** - paramsä»å¯¹è±¡å˜ä¸ºPromise
2. **å­—æ®µæ˜ å°„è½¬æ¢é”™è¯¯** - è¯»å–é”™è¯¯çš„å­—æ®µå
3. **DELETEè¯·æ±‚é…ç½®é”™è¯¯** - Content-Typeä¸ç©ºbodyå†²çª

### ä¿®å¤æªæ–½
1. æ›´æ–°æ‰€æœ‰åŠ¨æ€è·¯ç”±ï¼Œä½¿ç”¨awaitè§£åŒ…params
2. ä¿®æ­£å­—æ®µæ˜ å°„å‡½æ•°ï¼Œè¯»å–æ­£ç¡®çš„å­—æ®µå
3. ç§»é™¤DELETEè¯·æ±‚çš„headersé…ç½®

### æµ‹è¯•éªŒè¯
- æ‰€æœ‰APIè·¯ç”±æ­£å¸¸å·¥ä½œ
- CRUDåŠŸèƒ½å®Œå…¨å¯ç”¨
- æ•°æ®è½¬æ¢æ­£ç¡®
- é”™è¯¯å¤„ç†å®Œå–„

---

## ğŸ“ æœ€ç»ˆè¯„ä»·

æµç¨‹å¼•æ“ç®¡ç†é¡µé¢åŠŸèƒ½å·²å®Œå…¨ä¿®å¤ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²å®ç°å¹¶ç»è¿‡éªŒè¯ã€‚ä¿®å¤äº†ä¸‰ä¸ªå…³é”®é—®é¢˜åï¼Œç³»ç»Ÿè¿è¡Œç¨³å®šï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½ã€‚

**ä¸»è¦ä¼˜ç‚¹**:
- âœ… åŠŸèƒ½å®Œæ•´ï¼Œè¦†ç›–CRUDå…¨æµç¨‹
- âœ… é”™è¯¯å¤„ç†å®Œå–„ï¼Œç”¨æˆ·åé¦ˆåŠæ—¶
- âœ… ç•Œé¢ç¾è§‚ï¼Œäº¤äº’æµç•…
- âœ… ä»£ç è´¨é‡é«˜ï¼Œç¬¦åˆNext.js 16è§„èŒƒ
- âœ… æ•°æ®è½¬æ¢æ­£ç¡®ï¼Œå‰åç«¯å¯¹æ¥æ— è¯¯

**éœ€è¦ä¼˜åŒ–**:
- âš ï¸ è§£å†³çŠ¶æ€æ˜ å°„é—®é¢˜ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**å»ºè®®**: ç³»ç»Ÿå·²å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼ŒçŠ¶æ€æ˜ å°„é—®é¢˜å¯ä»¥åœ¨åç»­ç‰ˆæœ¬ä¸­ä¼˜åŒ–ã€‚

---

## ğŸ”§ åç»­ä¼˜åŒ–å»ºè®®

### ä¼˜å…ˆçº§P0ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
æ— 

### ä¼˜å…ˆçº§P1ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
1. è§£å†³çŠ¶æ€æ˜ å°„é—®é¢˜
   - æ–¹æ¡ˆA: ä¿®æ”¹åç«¯æ•°æ®åº“ç»“æ„ï¼Œæ·»åŠ statuså­—æ®µ
   - æ–¹æ¡ˆB: ä¿®æ”¹å‰ç«¯ï¼Œç§»é™¤draftçŠ¶æ€
   - æ–¹æ¡ˆC: å‰ç«¯ç»´æŠ¤draftæ ‡å¿—ä½

### ä¼˜å…ˆçº§P2ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
2. æ·»åŠ æµç¨‹å¤åˆ¶åŠŸèƒ½
   - åŸºäºç°æœ‰æµç¨‹åˆ›å»ºå‰¯æœ¬
   - è‡ªåŠ¨è°ƒæ•´åç§°ï¼ˆæ·»åŠ "-å‰¯æœ¬"åç¼€ï¼‰
   - ä¿æŒåŸæœ‰é…ç½®ä¸å˜

3. æ·»åŠ æµç¨‹ç‰ˆæœ¬ç®¡ç†
   - ä¿å­˜å†å²ç‰ˆæœ¬
   - æ”¯æŒç‰ˆæœ¬å›æ»š
   - æ˜¾ç¤ºç‰ˆæœ¬å¯¹æ¯”

4. æ·»åŠ æ‰¹é‡æ“ä½œ
   - æ‰¹é‡åˆ é™¤æµç¨‹
   - æ‰¹é‡å¯ç”¨/åœç”¨
   - æ‰¹é‡å¯¼å‡º

5. ä¼˜åŒ–åŠ è½½æ€§èƒ½
   - æ·»åŠ è™šæ‹Ÿæ»šåŠ¨
   - åˆ†é¡µåŠ è½½
   - ç¼“å­˜æœºåˆ¶

6. æ·»åŠ æœç´¢å’Œç­›é€‰
   - æŒ‰åç§°æœç´¢
   - æŒ‰çŠ¶æ€ç­›é€‰
   - æŒ‰è§¦å‘ç±»å‹ç­›é€‰

### ä¼˜å…ˆçº§P3ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
7. æ·»åŠ æµç¨‹æ¨¡æ¿
   - é¢„è®¾å¸¸ç”¨æµç¨‹æ¨¡æ¿
   - ä¸€é”®åˆ›å»ºæ ‡å‡†æµç¨‹
   - æ¨¡æ¿åˆ†ç±»ç®¡ç†

8. æ·»åŠ æµç¨‹å¯¼å…¥å¯¼å‡º
   - æ”¯æŒJSONæ ¼å¼å¯¼å…¥
   - æ”¯æŒJSONæ ¼å¼å¯¼å‡º
   - æ”¯æŒæ‰¹é‡å¯¼å…¥

9. æ·»åŠ æµç¨‹ç»Ÿè®¡
   - æ‰§è¡ŒæˆåŠŸç‡ç»Ÿè®¡
   - æ‰§è¡Œæ—¶é•¿ç»Ÿè®¡
   - æµç¨‹ä½¿ç”¨é¢‘ç‡ç»Ÿè®¡

10. æ·»åŠ æµç¨‹å¯è§†åŒ–ç¼–è¾‘å™¨
    - æ‹–æ‹½å¼èŠ‚ç‚¹ç¼–æ’
    - å¯è§†åŒ–è¿çº¿
    - å®æ—¶é¢„è§ˆ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [WorkTool AI 2.1 æ”¹é€ è®¡åˆ’](./WorkTool_AI_2.1_æ”¹é€ è®¡åˆ’ä¸å®æ–½æ­¥éª¤.md)
- [åç«¯APIæ–‡æ¡£](../server/routes/flow-engine.api.js)
- [æ•°æ®åº“è¡¨ç»“æ„](../server/database/migrations/009_create_flow_engine_tables.sql)
- [æµç¨‹å¼•æ“æœåŠ¡](../server/services/flow-engine.service.js)

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-04  
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-02-04
