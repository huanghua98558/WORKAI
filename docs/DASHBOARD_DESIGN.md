# WorkTool AI 智能监控仪表盘设计文档

## 概述

新的仪表盘设计采用现代化、数据驱动的布局，提供系统运行状态的实时监控和可视化展示。

## 设计理念

### 1. 色彩系统
- **绿色** - 系统正常、健康状态
- **蓝色** - 监控数据、机器人状态
- **紫色** - 会话、AI相关
- **红色** - 紧急告警、错误状态
- **黄色/橙色** - 警告、高活跃度

### 2. 布局结构

```
┌─────────────────────────────────────────────────────────┐
│  页面头部：标题、描述、最后更新时间、刷新按钮              │
├─────────────────────────────────────────────────────────┤
│  顶部状态栏（3列）：                                       │
│  - 系统状态（绿色渐变）                                   │
│  - 在线机器人（蓝色渐变）                                 │
│  - 今日回调（紫色渐变）                                   │
├─────────────────────────────────────────────────────────┤
│  主要内容区域（3列）：                                     │
│                                                           │
│  左侧列 - 监控数据                                       │
│  ├── 今日监控摘要                                        │
│  │   ├── 回调处理进度条                                  │
│  │   ├── AI响应进度条                                    │
│  │   ├── 活跃会话数                                      │
│  │   └── AI错误/回调错误统计                             │
│  └── 机器人状态（最多4个）                               │
│                                                           │
│  中间列 - 告警分析                                       │
│  ├── 告警概览                                            │
│  │   ├── 待处理/已处理/已升级 卡片                        │
│  │   ├── 告警级别分布（进度条）                           │
│  │   └── 影响范围统计                                    │
│  └── 关键指标                                            │
│      ├── 平均响应时间                                     │
│      ├── 平均升级次数                                     │
│      └── 最大升级次数                                     │
│                                                           │
│  右侧列 - 活跃排行                                       │
│  ├── Top活跃群组（前5个）                                │
│  └── Top活跃用户（前5个）                                │
│                                                           │
├─────────────────────────────────────────────────────────┤
│  底部区域 - 实时会话列表                                  │
│  └── 显示当前活跃的会话（最多5个）                         │
└─────────────────────────────────────────────────────────┘
```

## 功能模块详解

### 1. 顶部状态栏

#### 系统状态卡片
- **背景**：绿色到翠绿渐变
- **内容**：系统运行状态徽章
- **交互**：显示所有服务运行正常

#### 在线机器人卡片
- **背景**：蓝色到靛蓝渐变
- **内容**：在线机器人数量/总数
- **交互**：动态更新机器人状态

#### 今日回调卡片
- **背景**：紫色到粉色渐变
- **内容**：今日总回调数、成功率徽章
- **交互**：显示成功/失败数量

### 2. 监控数据（左侧列）

#### 今日监控摘要
- **回调处理**：
  - 显示成功/总数比例
  - 蓝色渐变进度条
- **AI响应**：
  - 显示成功率
  - 绿色渐变进度条
- **活跃会话**：
  - 显示当前活跃会话数
  - 紫色图标
- **系统指标**：
  - AI错误数（红色）
  - 回调错误数（橙色）

#### 机器人状态
- 显示前4个机器人的状态
- 每个机器人显示：
  - 状态图标（在线/离线）
  - 昵称和名称
  - 消息处理数
  - 健康状态图标和成功率

### 3. 告警分析（中间列）

#### 告警概览
- **三个统计卡片**：
  - 待处理（蓝色）
  - 已处理（绿色）
  - 已升级（橙色）
- **级别分布**：
  - Critical（红色）
  - Warning（黄色）
  - Info（蓝色）
  - 带百分比进度条
- **影响范围**：
  - 受影响群组数
  - 受影响用户数
  - 受影响会话数

#### 关键指标
- 平均响应时间
- 平均升级次数
- 最大升级次数

### 4. 活跃排行（右侧列）

#### Top活跃群组
- 显示前5个最活跃的群组
- 每个群组显示：
  - 排名徽章（金/银/铜）
  - 群组ID
  - 活跃度徽章（高/中/低）
  - 消息数

#### Top活跃用户
- 显示前5个最活跃的用户
- 每个用户显示：
  - 排名徽章
  - 用户ID
  - 活跃度徽章
  - 消息数

### 5. 实时会话（底部区域）

- 显示当前活跃的会话列表（最多5个）
- 每个会话显示：
  - 状态徽章（自动/人工）
  - 用户名和群组名
  - 最后一条消息
  - 消息数
  - 最后活跃时间

## API接口对接

### 监控相关接口
1. `GET /api/monitoring/summary` - 今日监控摘要
2. `GET /api/monitoring/robots-status` - 机器人状态
3. `GET /api/monitoring/active-groups?limit=5` - 活跃群组排行
4. `GET /api/monitoring/active-users?limit=5` - 活跃用户排行

### 告警相关接口
1. `GET /api/alerts/analytics/overview` - 告警概览
2. `GET /api/proxy/admin/sessions/active?limit=5` - 活跃会话

## 数据刷新机制

### 自动刷新
- **刷新间隔**：60秒
- **刷新策略**：
  - 首次加载时并行请求所有API
  - 后续刷新时加载所有数据
  - 显示最后更新时间

### 手动刷新
- 点击"刷新"按钮立即重新加载所有数据
- 刷新时显示加载状态

## 响应式设计

### 桌面端（≥1024px）
- 三列布局
- 完整显示所有内容

### 平板端（768px - 1023px）
- 两列布局
- 左侧和中间列合并

### 移动端（<768px）
- 单列布局
- 卡片垂直堆叠

## 交互特性

### 悬停效果
- 卡片悬停时阴影增强
- 颜色轻微变化

### 过渡动画
- 进度条平滑过渡
- 数据更新淡入效果
- 加载状态动画

### 可访问性
- 支持键盘导航
- 适当的对比度
- 清晰的视觉层次

## 性能优化

### 数据加载
- 并行请求多个API
- 超时处理（3秒）
- 错误容错

### 渲染优化
- 使用React.memo减少重渲染
- 条件渲染优化
- 避免不必要的计算

### 状态管理
- 本地状态管理
- 最小化重渲染范围

## 未来扩展

### 计划功能
1. 告警趋势图表（折线图）
2. 更多自定义选项
3. 导出报表功能
4. 实时WebSocket连接
5. 更多的可视化图表

### 可改进项
1. 添加数据筛选功能
2. 自定义刷新间隔
3. 告警推送通知
4. 数据钻取功能
5. 历史数据对比

## 技术栈

- **框架**：React 19
- **UI组件**：shadcn/ui
- **样式**：Tailwind CSS 4
- **图标**：Lucide React
- **类型**：TypeScript 5

## 访问地址

- **开发环境**：http://localhost:5000/new-dashboard
- **生产环境**：根据部署配置

## 注意事项

1. 所有API接口需要正确配置CORS
2. 确保数据库连接正常
3. 监控数据需要定期更新
4. 告警数据需要预先创建表结构
5. 机器人状态需要实时同步

## 更新日志

### v2.0.0 (2026-02-05)
- 完全重新设计仪表盘布局
- 对接所有新的监控和告警API
- 实现自动刷新功能
- 添加响应式设计
- 优化性能和用户体验
